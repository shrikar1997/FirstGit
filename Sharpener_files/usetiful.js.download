(()=>{"use strict";var t={};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}();const e=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s=`${t}${e?`-${e}`:""}`;return{prefix:s,overlay:`${t}-overlay`,top:`${s}-top`,left:`${s}-left`,right:`${s}-right`,bottom:`${s}-bottom`,visible:`${s}-visible`,bubble:`${s}-bubble`,bubbleContent:`${s}-bubble-content`,bubbleContentWithoutTitle:`${s}-bubble-content--without-title`,beacon:`${s}-beacon`,beaconAround:`${s}-beacon__around`,beaconIconic:`${s}-beacon__iconic`,beaconIconicQuestion:`${s}-beacon__iconic-question`,beaconIconicInformation:`${s}-beacon__iconic-information`,bubbleInvisible:`${s}-bubble--invisible`,modal:`${s}-modal`,modalInner:`${s}-modal-inner`,dotProgressBPadding:`${s}-dot-progress--bpadding`,circleProgressBPadding:`${s}-circle-progress--bpadding`,title:`${s}-title`,titleWithoutProgress:`${s}-title--without-progress`,description:`${s}-description`,slideout:`${s}-slideout`,slideoutInner:`${s}-slideout-inner`,articleInner:`${s}-article-inner`,actions:`${s}-actions`,searchBox:`${s}-search-box`,searchResults:`${s}-search-results`,actionsPaddingAround:`${s}-actions--padding-around`,redirect:`${s}-redirect`,delay:`${s}-delay`,redirectInner:`${s}-redirect-inner`,triggerEventInner:`${s}-trigger-event-inner`,pageActionInner:`${s}-page-action-inner`,buttonMain:`${s}-button-main`,buttonMainTourSelection:`${s}-button-selection`,buttonMainLeft:`${s}-button-main--left`,tourSelection:`${s}-tour-selection`,button:`${s}-button`,buttonIcon:`${s}-button-icon`,buttonIconRight:`${s}-button-icon--right`,buttonBlock:`${s}-btn-block`,buttonPrimary:`${s}-button-primary`,buttonClose:`${s}-close-button`,buttonBack:`${s}-back-button`,buttonGroup:`${s}-button-group`,badge:`${s}-badge`,badgeFree:`${s}-free-badge`,spaceMaker:`${s}-space-maker`,spaceMakerPlus:`${s}-space-maker--plus`,spaceMakerDouble:`${s}-space-maker--double`,done:`${s}-done`,content:`${s}-content`,contentWithoutTitle:`${s}-content--without-title`,feedback:`${s}-feedback`,feedbackTitle:`${s}-feedback-title`,npsTitles:`${s}-feedback-nps-titles`,inProgress:`${s}-inprogress`,progress:`${s}-progress`,progressValue:`${s}-progress-value`,dotProgress:`${s}-dot-progress`,dotProgressRight:`${s}-dot-progress--right`,dotProgressCenter:`${s}-dot-progress--center`,dotProgressLeft:`${s}-dot-progress--left`,dotProgressFree:`${s}-dot-progress--free`,dotProgressItem:`${s}-dot-progress__item`,dotProgressActiveItem:`${s}-dot-progress__item--active`,circleProgress:`${s}-circle-progress`,circleProgressRight:`${s}-circle-progress--right`,circleProgressLeft:`${s}-circle-progress--left`,circleProgressCenter:`${s}-circle-progress--center`,circleProgressFree:`${s}-circle-progress--free`,circleProgressInner:`${s}-circle-progress__inner`,circleProgressBar:`${s}-circle-progress__bar`,circleProgressBarLeft:`${s}-circle-progress__bar--left`,circleProgressBarRight:`${s}-circle-progress__bar--right`,circleProgressProgress:`${s}-circle-progress__progress`,numberProgress:`${s}-number-progress`,numberProgressRight:`${s}-number-progress--right`,numberProgressLeft:`${s}-number-progress--left`,numberProgressCenter:`${s}-number-progress--center`,numberProgressFree:`${s}-number-progress--free`,numberProgressDivider:`${s}-number-progress__divider`,progressTop:`${s}-progress--top`,progressBottom:`${s}-progress--bottom`,progressbar:`${s}-progress-bar`,notification:`${s}-notification`,notificationInner:`${s}-notification-inner`,notificationSearchInner:`${s}-notification-inner--search`,static:`${s}-static`,alert:`${s}-alert`,preview:`${s}-preview`,pointer:"pointer",bottomAction:`${s}-bottom-action`,svgIcon:"svg-icon",textLeft:`${s}-text-left`,textRight:`${s}-text-right`,scrollable:`${s}-scrollable`,congratulation:`${s}-congratulation`}},s=function(){return e("uf",(t=>{var e,s,i,r;const n=null===(r=null===(i=null===(s=null===(e=null==t?void 0:t.split("/"))||void 0===e?void 0:e.pop())||void 0===s?void 0:s.split("-"))||void 0===i?void 0:i.pop())||void 0===r?void 0:r.replace(".css","");return n&&"default"!==n?n:null})(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null))},i="ufp",r=e("uf"),n=(e(i),"nextStepTrigger"),o="once-then-manual",a="inProgress",l="closed",c="not-started",h="showProductTour",u="productTourStep",d="ufTag-",p="devkitCurrentChecklist",g="EXAMPLE_USER_ID",m="uf_triggerTour",f="uf_manualRedirectURL",v="toursSelection",T="pulsatingPoint",w="questionMark",b="infoPoint",S="tour",y="checklist",C="assistant",k={toursEvents:"usetiful:toursEvent",tourEvents:"usetiful:tourEvent",checklistDismissed:"usetiful:checklist.dismissed",setDisplay:"usetiful:setDisplay",initContentLoader:"usetiful:initContentLoader",placeAllButton:"usetiful:placeAllButton",placeInitialTriggers:"usetiful:placeInitialTriggers",initAvailableTours:"usetiful:initAvailableTours",setCurrentTour:"usetiful:setCurrentTour",updateButtonTours:"usetiful:updateButtonTours",listenForRedirect:"usetiful:listenForRedirect",stopListeningForRedirect:"usetiful:stopListeningForRedirect",goToNextStep:"usetiful:goToNextStep",goToPreviousStep:"usetiful:goToPreviousStep",closeTour:"usetiful:closeTour",setTourTriggerToLocalStorage:"usetiful:setTourTriggerToLocalStorage",moveToStep:"usetiful:moveToStep",setProgress:"usetiful:setProgress",placeNextStepAppearTrigger:"usetiful:placeNextStepAppearTrigger",tipHidden:"usetiful:tipHidden"};var L;const E=!1,I=E?"usetifulPluginScript":"usetifulScript",D=document.querySelector(`#${I}`);let x="";x=(null==D?void 0:D.hasAttribute("data-hostname"))?D&&`${D.getAttribute("data-hostname")}/`||"":D&&(null===(L=D.getAttribute("src"))||void 0===L?void 0:L.replace(/(\/\/.*?\/).*/g,"$1"))||"";const A=`${x.split("/")[0]}//`,P=x.replace(/(^\w+:|^)\/\//,"").replace("www.",""),$=D?D.getAttribute("data-token"):"",O=1===(D&&parseInt(D.getAttribute("data-debug")||"0",10)||0),B=1===(D&&parseInt(D.getAttribute("data-with-drafts")||"0",10)||0),N=1===(D&&parseInt(D.getAttribute("data-only-tips")||"0",10)||0),R=1===(D&&parseInt(D.getAttribute("data-only-checklists")||"0",10)||0),U=null!==window.localStorage.getItem("pauseProductionTour"),M=D&&parseInt(D.getAttribute("data-preview-tour-id")||"0",10)||0,W=M>0,H=$&&32===$.length,j=P.startsWith("dev."),F={};let _="";if(H&&(_="/user/data.json"),B&&(F.withDrafts=O.toString()),N&&(F.onlyTips=O.toString()),R&&(F.onlyChecklists=O.toString()),W&&(F.previewTourId=M.toString()),Object.keys(F).length>0){const t=new URLSearchParams(F);_+=`?${t.toString()}`}const q=E?"preview_tours":"tours",z=E?"preview_uf_smartTips":"uf_smartTips",J=E?"preview_checklistsRedirects":"checklistsRedirects",V=function(t){O&&(arguments.length>1&&void 0!==arguments[1]&&arguments[1]?console.info(`%c Usetiful: ${t}`,"background: #387DFF; color: #edf3ff"):console.info(`Usetiful: ${t}`))},K=t=>{O&&console.warn(`Usetiful: ${t}`)},G=t=>{O&&console.log(t)},X=t=>{let e=t;try{return!t||t instanceof Object||(e=JSON.parse(t)),e}catch(t){V("Targets field is not JSON.")}return!1};function Y(t,e){const{name:s,showEverytime:i,autoplay:r,trigger:n}=t,a=!i&&e.getObjectStatus(s)!==l,c=r&&i,h=n&&n.type===o&&e.getObjectStatus(s)===l;return V(`manualTourShown = ${a?a.toString():""}, automaticTourShow = ${c?c.toString():""}, showEverytime = ${i?i.toString():""}`),a||c||i||h}function Q(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];E&&t&&t.trigger&&(!e&&"click"===t.trigger.type||"click"!==t.trigger.type)&&tt(t.trigger.type,t.trigger.element)}function Z(){tt("clear waiting","done")}function tt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";window.postMessage({type:t,text:e,resource:"USETIFUL_SCRIPT"},"*")}const et=class{constructor(){this.instances={}}findServices(t){const e=[];return t.forEach((t=>{const s=this.get(t);e.push(s)})),e}registerClass(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];null===this.get(t)&&(this.instances[t]=new e(...this.findServices(s)))}registerConstant(t,e){null===this.get(t)&&(this.instances[t]=e)}registerFunction(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];null===this.get(t)&&(this.instances[t]=e(...this.findServices(s)))}get(t){return Object.prototype.hasOwnProperty.call(this.instances,t)?this.instances[t]:null}};const st=class{constructor(){this.cookieName="usetiful-visitor-ident",this.cookieLifeTimeDays=365,this.isNewVisitor=!1,this.getIdent=()=>{let t=this.getCookie(this.cookieName);return t||(t=this.generateUUID(),this.isNewVisitor=!0,this.setCookie(this.cookieName,t,this.cookieLifeTimeDays)),t},this.generateUUID=()=>{let t=(new Date).getTime(),e=performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(s=>{let i=16*Math.random();return t>0?(i=(t+i)%16|0,t=Math.floor(t/16)):(i=(e+i)%16|0,e=Math.floor(e/16)),("x"===s?i:i?3:8).toString(16)}))},this.setCookie=(t,e,s)=>{let i="";if(s){const t=new Date;t.setTime(t.getTime()+24*s*60*60*1e3),i=`; expires=${t.toUTCString()}`}document.cookie=`${t}=${e||""}${i}; path=/`},this.getCookie=t=>{const e=document.cookie.match(`(^|;) ?${t}=([^;]*)(;|$)`);return e?e[2]:null}}},it="showSmartTip",rt="showStep",nt="redirect",ot="delay",at="triggerEvent",lt="pageAction",ct="pageLeft",ht="closeTour",ut="Progressor",dt="Reports",pt="PageLeft",gt=Object.freeze({horizontalProgressBar:{title:"Horizontal Progress Bar",key:1},dots:{title:"Dots",key:2},stepNumber:{title:"Step Number",key:3},circleProgressBar:{title:"Circle Progress Bar",key:4}}),mt="uf_tags",ft="uf_reports_to_send",vt="POST";var Tt=function(t,e,s,i){return new(s||(s=Promise))((function(r,n){function o(t){try{l(i.next(t))}catch(t){n(t)}}function a(t){try{l(i.throw(t))}catch(t){n(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(o,a)}l((i=i.apply(t,e||[])).next())}))},wt=function(t,e){var s={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(s[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(s[i[r]]=t[i[r]])}return s};function bt(t){let{id:e,action:s,actionAt:i,visitorIdent:r,tags:n,debug:o,isDevKit:a}=t;return{id:e,type:s===it?"smartTip":"step",event:{[it]:"show",[rt]:"show",[ht]:"close",[nt]:"redirect",[ot]:"delay",[at]:"triggerEvent",[lt]:"pageAction"}[s],eventAt:"string"==typeof i?i:null==i?void 0:i.toISOString(),visitorIdent:r,isPreview:o,tags:n,isDevKit:a}}function St(t){var{actionAt:e}=t,s=wt(t,["actionAt"]);return delete s.tags,Object.assign(Object.assign({},s),{actionAt:null==e?void 0:e.toString()})}const yt=class{constructor(t,e,s,i){var r=this;this.batchSize=10,this.minSendInterval=1e4,this.maxSendInterval=6e4,this.sendIntervalId=null,this.syncToLS=()=>{window.localStorage.setItem(ft,JSON.stringify(this.data))},this.getLSData=()=>{const t=window.localStorage.getItem(ft),e=t?JSON.parse(t):[];return this.data&&this.data.length>0?this.data:e},this.add=t=>Tt(this,void 0,void 0,(function*(){const e=this.getLSData(),s=yield this.usetifulTags.getTags(),i=Object.assign(Object.assign({},t),{actionAt:(new Date).toISOString(),visitorIdent:this.visitor.getIdent(),debug:!!this.debug,tags:s});var r,n;e.length>=1&&(r=t,n=e[e.length-1],!["tourId","stepIndex","id","action"].find((t=>r[t]!==n[t])))||(this.data.push(i),this.send())})),this.send=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];r.syncToLS();const e=r.getLSData(),s=e.length&&t,i=(new Date).getMilliseconds();if(!s&&(e.length<r.batchSize||i<r.nextPossibleSend))return;const n=e.filter((t=>t.action!==it)).map(St),o=e.filter((t=>t.action!==ct)).map(bt);r.nextPossibleSend=(new Date).getMilliseconds()+r.minSendInterval,r.reschedule(),n.length&&r.api.post("/report",n),o.length&&(r.reporterApi.postWithoutResponse(`${x}${r.reporterApi.basePath}/entity-events/`,o,!0),r.clearData())},this.clearData=()=>{this.data=[],this.syncToLS()},this.reschedule=()=>{this.sendIntervalId&&clearInterval(this.sendIntervalId),this.sendIntervalId=setInterval((()=>this.send(!0)),this.maxSendInterval)},this.beforeunloadEvent=()=>{this.send(!0)},this.init=()=>{this.beforeUnload.setAction(dt,this.beforeunloadEvent),this.reschedule()},this.destroy=()=>{this.beforeUnload.removeAction(dt),clearInterval(this.sendIntervalId)},this.api=t,this.reporterApi=e,this.usetifulTags=s,this.debug=O,this.data=this.getLSData().length>0?this.getLSData():[],this.syncToLS(),this.visitor=new st,this.beforeUnload=i}};const Ct=class{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api-space";this.apiToken=t,this.basePath=e}request(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const r=new XMLHttpRequest;return r.open(t,`${x}${this.basePath}${e}`,i),r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.setRequestHeader("Content-Type","application/json; charset=utf-8"),r.setRequestHeader("X-AUTH-TOKEN",this.apiToken),null!==s?r.send(JSON.stringify(s)):r.send(),r}get(t,e){return this.request("GET",t,e)}post(t,e){return this.request(vt,t,e)}postWithoutResponse(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(e)try{fetch(t,{keepalive:!0,method:vt,headers:Object.assign(Object.assign({"Content-Type":"application/json"},s?{"X-AUTH-TOKEN":this.apiToken}:{}),i),body:JSON.stringify(e)})}catch(t){console.error(t)}}},kt=t=>{const e=new CustomEvent(k.setDisplay,{detail:{value:t}});document.dispatchEvent(e)},Lt=t=>{let e=t.name;t.tourId?e=k.tourEvents:t.isToursContext&&(e=k.toursEvents);const s=new CustomEvent(e,{detail:{event:t.name,tourId:t.tourId,isToursContext:t.isToursContext,props:t.details}});return document.dispatchEvent(s),V(`Event name ${t.name} send to entityID: ${t.tourId}, toursContext: ${t.isToursContext}, and details ${t.details}`),s};const Et=class{constructor(t){var e=this;this.activeTriggers="[]",this.clearTourTriggerAfterDelay=function(t){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];s&&Lt({isToursContext:!0,name:k.listenForRedirect}),setTimeout((()=>{window.usetiful_isAboutToRefresh?s&&(Lt({isToursContext:!0,name:k.stopListeningForRedirect}),window.usetiful_isAboutToRefresh=null):e.removeTriggerFromLocalStorage(t)}),1500)},this.storage=t;const s=this.storage.getItem(m);s?this.setTriggers(s):this.setTriggers("[]"),this.tourTriggerFromURL=-1,this.stepTriggerFromURL=-1}getTriggers(){return this.updateTriggers(),this.activeTriggers}setTriggers(t){t&&(this.activeTriggers=t)}updateTriggers(){const t=this.storage.getItem(m);this.setTriggers(t)}hasTourTrigger(t){const e=this.getTriggers(),s=JSON.parse(e);return!!s&&s.includes(t)}removeAllTriggersFromLocalStorage(){this.storage.removeItem(m),this.setTriggers("[]")}removeTriggerFromLocalStorage(t){const e=this.getTriggers(),s=JSON.parse(e);if(s){if(s.indexOf(t)>=0){const e=s.filter((e=>e!==t));e.length>0?(this.storage.setItem(m,JSON.stringify(e)),this.setTriggers(JSON.stringify(e))):this.removeAllTriggersFromLocalStorage()}}}setTourTriggerToLocalStorage(t){let e=[];const s=this.getTriggers(),i=JSON.parse(s);i&&(e=i.filter((e=>e!==t))),e.push(t),e.length>0&&(this.setTriggers(JSON.stringify(e)),this.storage.setItem(m,JSON.stringify(e)))}hasTourTriggerInUrl(){try{this.tourTriggerFromURL=-1;const t=window.location.search,e=new URLSearchParams(t),s=e.get(h);if(s){const t=e.entries();for(const[e,s]of t)if(e.startsWith(d)){const t=e.replace(d,"");window.usetifulTags||(window.usetifulTags={}),window.usetifulTags[t]=s}this.tourTriggerFromURL=Number(s);const i=e.get(u);i&&(this.stepTriggerFromURL=Number(i))}return-1!==this.tourTriggerFromURL}catch(t){return!1}}checkTourTriggers(){if(this.hasTourTriggerInUrl()){const t=this.tourTriggerFromURL;this.removeAllTriggersFromLocalStorage(),this.setTourTriggerToLocalStorage(t)}}};let It=window.location.href;const Dt="onPageChange",xt="onElementHide",At=()=>{const t=new CustomEvent(Dt);V("change url event call"),window.dispatchEvent(t)},Pt=(e,s,i)=>t.g.setInterval((()=>((t,e,s)=>{var i;let r=document.body;if(s&&(r=null===(i=null===document||void 0===document?void 0:document.querySelector(s))||void 0===i?void 0:i.shadowRoot),r&&!r.contains(t)){const t=new CustomEvent(xt,{detail:e});window.dispatchEvent(t)}})(e,s,i)),500),$t=t=>clearInterval(t),Ot=()=>setInterval((()=>{return(t=window.location.href)!==It&&(At(),It=t),void(It=window.location.href);var t}),500);const Bt=class{constructor(t,e){this.loadConfig=t=>{if(!H)return void console.error(`The usetiful token "${$}" has invalid format. Please check if you have inserted the script correctly.`);if(!E&&U)return void V("Script is paused by plugin");const e=this.api.get(_);e.onload=e=>{let{currentTarget:{status:s,response:i}}=e;if(Ot(),s>=200&&s<400){const e=JSON.parse(i);t(e),window.addEventListener(Dt,(()=>{V("call page change event"),this.beforeUnload.beforeUnloadListener(),t(e)}))}},e.onerror=()=>{K("Usetiful: connection error")}},this.loadCriticalCss=()=>{const t=document.getElementsByTagName("head")[0],e=document.createElement("style");e.innerHTML="[data-uf-content] {display: none}",t.appendChild(e)},this.loadTheme=(t,e)=>{const s=document.querySelector(`link[href="${t}"]`);if(null===s||s.getAttribute("href")!==t){const s=document.getElementsByTagName("head")[0],i=document.createElement("link");i.rel="stylesheet",i.type="text/css",i.href=t,"function"==typeof e&&(i.onload=e),s.appendChild(i)}else"function"==typeof e&&e()},this.api=t,this.beforeUnload=e}};const Nt=class{constructor(){this.init=()=>{this.isListenerPlaced||this.placeListener()},this.beforeUnloadListener=()=>{V("beforeUnloadListener event called"),this.actions.forEach(((t,e)=>{t&&(2===e?setTimeout((()=>t()),1):t())}))},this.placeListener=()=>{this.isListenerPlaced||(window.addEventListener("beforeunload",this.beforeUnloadListener),this.isListenerPlaced=!0)},this.removeListener=()=>{this.isListenerPlaced&&(window.removeEventListener("beforeunload",this.beforeUnloadListener),this.isListenerPlaced=!1)},this.setAction=(t,e)=>{switch(t){case pt:this.actions[0]=e;break;case dt:this.actions[1]=e;break;case ut:this.actions[2]=e}},this.removeAction=t=>{this.setAction(t,(()=>{}))},this.destroy=()=>{this.removeListener(),this.actions=new Array(3)},this.isListenerPlaced=!1,this.actions=new Array(3)}},Rt=`${A}${j?"progressor-":"progressor."}${P}`;const Ut=class{constructor(t,e,s,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"api";this.loadedUserData={},this.dataChanged=!1,this.beforeunloadEvent=t=>{this.saveToApi(t)},this.apiToken=t,this.basePath=r,this.usetifulTags=e,this.beforeUnload=s,this.api=i,this.loadFromApi()}init(){this.setSaveInterval(),this.setUnloadListener()}destroy(){this.beforeUnload.removeAction(ut),clearInterval(this.sendIntervalId)}request(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=new XMLHttpRequest;if(r.open(t,`${Rt}${this.basePath}/${e}`,i),r.setRequestHeader("X-Requested-With","XMLHttpRequest"),null!==s?r.send(JSON.stringify(s)):r.send(),200===r.status){const{responseText:t}=r;return JSON.parse(t)}}getUserId(){return this.usetifulTags.getUserId()}loadFromApi(){const t=this.getUserId();if(null===t)return;const e={userId:t,accountToken:this.apiToken},s=this.request(vt,"get",e);s&&"string"==typeof s&&(this.loadedUserData=JSON.parse(s))}getUserData(t){return this.isLoadedDataSameAsLS(),Object.prototype.hasOwnProperty.call(this.loadedUserData,t)?this.loadedUserData[t]:null}saveUserData(t,e){null!==this.getUserId()&&("object"!=typeof this.loadedUserData&&(this.loadedUserData={}),this.loadedUserData[t]=e,this.dataChanged=!0)}saveToApi(t){if(this.dataChanged){const e={userId:t,accountToken:this.apiToken,data:this.loadedUserData};this.api.postWithoutResponse(`${Rt}${this.basePath}/save`,e,!1,{"x-requested-with":"XMLHttpRequest"}),this.dataChanged=!1}}setSaveInterval(){const t=this.getUserId();null!==t&&(this.sendIntervalId=setInterval((()=>this.saveToApi(t)),1e4))}setUnloadListener(){const t=this.getUserId();null!==t&&this.beforeUnload.setAction(ut,(()=>this.beforeunloadEvent(t)))}isLoadedDataSameAsLS(){let t=!0;return Object.keys(this.loadedUserData).forEach((e=>{this.loadedUserData[e]!==window.localStorage.getItem(e)&&(t=!1,console.error(`Usetiful: Data from progressor and local storage are not equal for the key: '${e}. It may result in wrong progress state.'`))})),t}},Mt=navigator.userAgent.indexOf("Opera")>-1,Wt=navigator.userAgent.indexOf("Firefox")>-1,Ht=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),jt=!!document.documentMode,Ft=!jt&&!!window.StyleMedia,_t=!Mt&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),qt=(_t||Mt)&&!!window.CSS,zt=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!1;return(s=>{const i=/(ipad|tablet|(android(?!.*mobile))|(windows(?!.*phone)(.*touch))|kindle|playbook|silk|(puffin(?!.*(IP|AP|WP))))/i.test(s),r=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(s)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(s.substr(0,4));(t?i:r)&&(e=!0)})(navigator.userAgent||navigator.vendor||window.opera),e},Jt=zt(),Vt=zt(!0),Kt=!Vt&&!Jt;var Gt=function(t,e,s,i){return new(s||(s=Promise))((function(r,n){function o(t){try{l(i.next(t))}catch(t){n(t)}}function a(t){try{l(i.throw(t))}catch(t){n(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(o,a)}l((i=i.apply(t,e||[])).next())}))};const Xt=class{constructor(t){this.reportDataPrivacy=0,this.setReportDataPrivacy=t=>{this.reportDataPrivacy=t},this.api=t}getTags(){return Gt(this,void 0,void 0,(function*(){const{usetifulTags:t}=window,e="object"==typeof t?Object.assign({},t):{};return e.autoGeneratedTags&&delete e.autoGeneratedTags,3===this.reportDataPrivacy?e:1===this.reportDataPrivacy?Object.fromEntries(Object.entries(e).filter((t=>{let[e]=t;return"userId"===e}))):2===this.reportDataPrivacy?Object.fromEntries(Object.entries(e).filter((t=>{let[e]=t;return"userId"!==e}))):4===this.reportDataPrivacy?Object.assign({},yield this.getAutoGenTags()):5===this.reportDataPrivacy?Object.assign(Object.assign({},e),yield this.getAutoGenTags()):{}}))}getTag(t){const{usetifulTags:e}=window;return e&&Object.prototype.hasOwnProperty.call(e,t)?e[t]:null}getUserId(){const t=this.getTag("userId");return t&&t!==g?t.toString():null}getAutoGenTags(){return new Promise((t=>{if(window.usetifulTags||(window.usetifulTags={}),window.usetifulTags.autoGeneratedTags&&window.usetifulTags.autoGeneratedTags.country)t(window.usetifulTags.autoGeneratedTags);else{const e=this.api.get("/geoip"),s=Object.assign(Object.assign({},(()=>{const t=navigator.userAgent;let e,s=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(s[1]))return e=/\brv[ :]+(\d+)/g.exec(t)||[],{browserName:"IE",browserVersion:e[1]||""};if("Chrome"===s[1]&&(e=t.match(/\bOPR|Edge\/(\d+)/),null!=e))return{browserName:"Opera",browserVersion:e[1]};s=s[2]?[s[1],s[2]]:[navigator.appName,navigator.appVersion,"-?"],e=t.match(/version\/(\d+)/i),null!=e&&s.splice(1,1,e[1]);const i={browserName:s[0],browserVersion:s[1]};return Mt?Object.assign(Object.assign({},i),{browserName:"Opera"}):Wt?Object.assign(Object.assign({},i),{browserName:"Firefox"}):Ht?Object.assign(Object.assign({},i),{browserName:"Safari"}):jt?Object.assign(Object.assign({},i),{browserName:"IE"}):Ft?Object.assign(Object.assign({},i),{browserName:"Edge"}):_t?Object.assign(Object.assign({},i),{browserName:"Chrome"}):qt?Object.assign(Object.assign({},i),{browserName:"Blink"}):i})()),{browserLanguage:window.navigator.userLanguage||window.navigator.language,deviceType:Jt?"Mobile":Vt?"Tablet":"Desktop",screenSize:`${window.screen.width} x ${window.screen.height}`});e.onload=e=>{let{currentTarget:{status:i,response:r}}=e;i>=200&&i<400?(window.usetifulTags.autoGeneratedTags=Object.assign({country:JSON.parse(r).country},s),t(window.usetifulTags.autoGeneratedTags)):t(Object.assign({country:"unknown"},s))}}}))}};let Yt=[],Qt=[];const Zt=class{constructor(t,e){this.parseBoolean=t=>!0===(t&&"string"==typeof t?JSON.parse(t):t),this.saveToStorage=t=>{this.progressorApi.saveUserData(this.getLocalStorageKey(),JSON.stringify(t))},this.isInPluginScript=t,this.progressorApi=e,this.processParseData()}getLocalStorageKey(){return"checklistsDismiss"}processParseData(){if(Qt[1])return;const t=this.progressorApi.getUserData(this.getLocalStorageKey());if(t&&"string"==typeof t){const e=JSON.parse(t);this.saveToLocalStorage(e),Yt=e}else this.loadFromLocalStorage(),this.saveToStorage(Yt);Qt.push(1)}loadFromLocalStorage(){const t=localStorage.getItem(this.getLocalStorageKey());t&&(Yt=JSON.parse(t))}isChecklistDismiss(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.isInPluginScript)return!1;if(t&&Yt&&Yt.length>0){const e=Yt.find((e=>e.id===t));if(e)return this.parseBoolean(e.value)}return!1}static clearParsedData(){Yt=[],Qt=[]}isAllChecklistsDismissed(t){let e=!0;for(const s of t){const{id:t}=s;this.isChecklistDismiss(t)||(e=!1)}return e}setDismissValue(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!this.isInPluginScript&&e){void 0!==Yt.find((t=>t.id===e))?Yt=Yt.map((s=>s.id===e?Object.assign(Object.assign({},s),{value:t}):s)):Yt.push({id:e,value:t}),this.saveToStorage(Yt),this.saveToLocalStorage(Yt)}}saveToLocalStorage(t){localStorage.setItem(this.getLocalStorageKey(),JSON.stringify(t))}},te="pointer",ee="modal",se="slideout",ie="redirect",re="delay",ne="triggerEvent",oe="pageAction",ae="bottom",le="top",ce="next",he="gototour",ue="Primary";function de(t,e){t&&t.width&&e.setAttribute("style",function(t){return t&&t.width?`max-width: 100%; width: ${t.width}px; min-width: auto;`:""}(t))}function pe(t,e){if(t&&t.classes){t.classes.split(" ").forEach((t=>{t&&e.classList.add(t)}))}}const ge=t=>{const{usetifulTags:e}=window,s=Object.keys(e||{});return null==s||s.forEach((s=>{t=null==t?void 0:t.replace(`{${s}}`,e[s])})),t},me=()=>{const t=localStorage.getItem(mt);if(t){const e=JSON.parse(t);Object.entries(e).forEach((t=>{const[e,s]=t;if(window.usetifulTags[e]&&window.usetifulTags[e]!==s)window.usetifulTags[e]=s;else if(!window.usetifulTags[e]){const t={};t[e]=s,Object.assign(window.usetifulTags,t)}}))}},fe=/^UsetifulShadowDom\([^)]*\) /,ve=t=>{let e=!0;if(!t)return!1;fe.test(t)&&(t=t.replace(fe,""));try{document.createDocumentFragment().querySelector(t)}catch(t){e=!1}return e},Te=t=>{var e;if(t)try{const s=t.match(fe);let i=s?s[0]:void 0;if(!i)return document.querySelector(t);i=i.replace("UsetifulShadowDom(",""),i=i.substring(0,i.length-2);const r=null===document||void 0===document?void 0:document.querySelector(i);return null===(e=null==r?void 0:r.shadowRoot)||void 0===e?void 0:e.querySelector(be(t))}catch(e){console.error(`Usetiful: Your Usetiful content leads to an incorrect element selector ${t}. Please check it out inside the editor.`)}},we=t=>{var e;if(t)try{const s=t.match(fe);let i=s?s[0]:void 0;if(!i)return document.querySelectorAll(t);i=i.replace("UsetifulShadowDom(",""),i=i.substring(0,i.length-2);const r=null===document||void 0===document?void 0:document.querySelector(i);return null===(e=null==r?void 0:r.shadowRoot)||void 0===e?void 0:e.querySelectorAll(be(t))}catch(e){console.error(`Usetiful: Your Usetiful content leads to an incorrect element selector ${t}. Please check it out inside the editor.`)}},be=t=>t.replace(fe,""),Se=t=>{const e=t.match(fe),s=e?e[0]:void 0;let i;return s&&(i=s.replace("UsetifulShadowDom(",""),i=i.substring(0,i.length-2)),{shadowDomSelector:i,childSelector:be(t),isAShadowDomSelector:Boolean(s)}},ye=(t,e)=>null!==t&&e in t,Ce=(t,e)=>t&&ye(t,"nodeName")&&t.nodeName.toLowerCase()===e,ke=t=>{var e;V("called destroyElement"),t instanceof HTMLElement&&(null===(e=t.parentNode)||void 0===e||e.removeChild(t))},Le=t=>{const e=Te(t);e instanceof HTMLElement&&(V(`called destroyElementBySelector ${t}`),ke(e))},Ee=(t,e)=>null!==t.closest(be(e)),Ie=t=>!(t&&t.offsetWidth||(null==t?void 0:t.offsetHeight)||(null==t?void 0:t.getClientRects().length));var De,xe,Ae,Pe,$e,Oe=function(t,e,s,i){if("a"===s&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?i:"a"===s?i.call(t):i?i.value:e.get(t)};De=new WeakMap,xe=new WeakMap,Ae=new WeakMap,Pe=new WeakMap,$e=new WeakMap;const Be=class{constructor(){var t=this;let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.createWrapper=t=>{const e=document.createElement("div");return t&&e.classList.add(t),e},this.setTheme=t=>{this.themeClasses=s(t)},this.setIsWatermark=t=>{this.isWatermark=t},this.appendButtonDataAttributes=t=>{t.classList.contains(this.themeClasses.button)&&(t.dataset.ufButton="button"),t.classList.contains(this.themeClasses.buttonPrimary)&&(t.dataset.ufButton="button-primary"),t.classList.contains(this.themeClasses.buttonClose)&&(t.dataset.ufButton="close"),t.classList.contains(this.themeClasses.buttonMain)&&(t.dataset.ufButton="button-main")},this.createButton=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const i=document.createElement("button");return i.type="button",i.innerHTML=ge(e),""!==s&&i.classList.add(s),t.appendButtonDataAttributes(i),i},this.createLink=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.themeClasses.button,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#";const r=document.createElement("a");return r.setAttribute("href",i),r.innerHTML=e,""!==s&&r.classList.add(s),t.appendButtonDataAttributes(r),r},this.createTitle=function(e,s){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.themeClasses.title;if(!i)return;const n=document.createElement(`h${e}`);return n.dataset.ufElement="title",n.innerHTML=ge(s),""!==r&&n.classList.add(r),n},this.createBubble=t=>{let{ident:e,contentHTML:s,title:i,progressBar:r,alignment:n,actionNumbers:o,progressType:a,closeButton:l,appendAdditionalContent:c,hotspot:h,customStyle:u}=t;const d=document.querySelector(`.${this.themeClasses.prefix}-${e}`),{body:p}=document;if(d instanceof HTMLElement)return d;if(!(p instanceof HTMLBodyElement))return;const g=document.createElement("div");g.dataset.ufContent="bubble";const m=p.appendChild(g);m.classList.add(this.themeClasses.bubble,`${this.themeClasses.prefix}-${e}`),m.setAttribute("id",e),u&&(de(u,m),pe(u,g));const f=document.createElement("div");f.classList.add(this.themeClasses.pointer),f.setAttribute("data-floating-arrow",""),m.appendChild(f),l instanceof HTMLButtonElement&&m.appendChild(l),i instanceof HTMLElement&&(i.dataset.ufElement="title",m.appendChild(i)),r instanceof HTMLElement&&m.appendChild(r);const v=this.createWrapper(this.themeClasses.bubbleContent);return null===i&&v.classList.add(this.themeClasses.bubbleContentWithoutTitle),v.innerHTML=ge(s)||"",m.appendChild(v),c&&c(m),m.appendChild(this.createSpaceMaker(n,o,a)),this.isWatermark&&m.appendChild(this.createWatermarkBadge()),h&&m.classList.add(this.themeClasses.bubbleInvisible),m},this.createWatermarkBadge=()=>{const t=this.createWrapper(this.themeClasses.badgeFree);return t.appendChild(this.createLink("Powered by Usetiful","",`${x}?utm_source=tour_badge`)),t},this.createSpaceMaker=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=t.createWrapper(t.themeClasses.spaceMaker);return s&&"center"!==e||i!==gt.dots.key?s||i!==gt.stepNumber.key&&i!==gt.circleProgressBar.key||r.classList.add(t.themeClasses.spaceMakerDouble):r.classList.add(t.themeClasses.spaceMakerPlus),r},De.set(this,((t,e)=>{const s=this.createWrapper(this.themeClasses.progress),i=this.createWrapper(this.themeClasses.progressbar);return 0===t&&s.classList.add("hidden"),"top"===e?s.classList.add(this.themeClasses.progressTop):"bottom"===e&&s.classList.add(this.themeClasses.progressBottom),i.style.width=`${t}%`,s.appendChild(i),s})),xe.set(this,((t,e,s,i)=>{const r=this.createWrapper(this.themeClasses.dotProgress);return i&&"center"!==t?"left"===t&&i?r.classList.add(this.themeClasses.dotProgressRight):"right"===t&&i&&r.classList.add(this.themeClasses.dotProgressLeft):r.classList.add(this.themeClasses.dotProgressCenter),this.isWatermark&&r.classList.add(this.themeClasses.dotProgressFree),[...Array(e)].forEach(((t,e)=>{const i=document.createElement("span");i.classList.add(this.themeClasses.dotProgressItem),e===s-1&&i.classList.add(this.themeClasses.dotProgressActiveItem),r.appendChild(i)})),r})),Ae.set(this,((t,e,s,i)=>{const r=this.createWrapper(this.themeClasses.numberProgress);i?"right"===s&&i&&r.classList.add(this.themeClasses.numberProgressLeft):r.classList.add(this.themeClasses.numberProgressCenter),this.isWatermark&&r.classList.add(this.themeClasses.numberProgressFree),r.innerHTML=t.toString();const n=document.createElement("span");return n.innerHTML="/",r.appendChild(n),r.innerHTML+=e.toString(),r})),Pe.set(this,((t,e,s)=>{let i=180*t/100*2,r=0;t>50&&(r=i-180,i=180);const n=this.createWrapper(this.themeClasses.circleProgress);s?"right"===e&&s&&n.classList.add(this.themeClasses.circleProgressLeft):n.classList.add(this.themeClasses.circleProgressCenter),this.isWatermark&&n.classList.add(this.themeClasses.circleProgressFree);const o=this.createWrapper(this.themeClasses.circleProgressInner),a=document.createElement("div"),l=this.createWrapper(this.themeClasses.circleProgressBar);l.classList.add(this.themeClasses.circleProgressBarLeft);const c=this.createWrapper(this.themeClasses.circleProgressProgress);c.style.transform=`rotate(${i}deg)`,l.appendChild(c);const h=this.createWrapper(this.themeClasses.circleProgressBar);h.classList.add(this.themeClasses.circleProgressBarRight);const u=this.createWrapper(this.themeClasses.circleProgressProgress);return u.style.transform=`rotate(${r}deg)`,h.appendChild(u),a.appendChild(l),a.appendChild(h),n.appendChild(o),n.appendChild(a),n})),this.progressBarController=(t,e,s)=>{const{title:i,publicTitle:r,position:n,type:o,alignment:a,actions:l}=t,c=""!==i&&!0===r,{progressType:h}=e,u=Oe(this,$e,"f").call(this,e.steps,s),d=u.activeStepIndex/(u.stepsLength/100);switch(h){case gt.dots.key:return Oe(this,xe,"f").call(this,a,u.stepsLength,u.activeStepIndex,l.length);case gt.stepNumber.key:return Oe(this,Ae,"f").call(this,u.activeStepIndex,u.stepsLength,a,l.length);case gt.circleProgressBar.key:return Oe(this,Pe,"f").call(this,d,a,l.length);default:{let t="";return c||o===te?c||(t=n&&"bottom"===n?"bottom":"top"):t="top",Oe(this,De,"f").call(this,d,t)}}},$e.set(this,((t,e)=>{const s={stepsLength:0,activeStepIndex:0};return t.forEach(((t,i)=>{t.type!==ie&&t.type!==re&&(s.stepsLength+=1,i<=e&&(s.activeStepIndex+=1))})),s})),this.createBeacon=(t,e,s,i)=>{const r=this.createWrapper(this.themeClasses.beacon);r.dataset.ufElement="beacon",s&&s!==T&&(r.classList.add(this.themeClasses.beaconIconic),s===w&&r.classList.add(this.themeClasses.beaconIconicQuestion),s===b&&r.classList.add(this.themeClasses.beaconIconicInformation));const{body:n}=document;if(n.appendChild(r),!s||s===T){const t=document.createElement("div");t.classList.add(this.themeClasses.beaconAround),r.appendChild(t)}return r.setAttribute("id",t),r.style.zIndex=e,i&&i.classes&&r.classList.add(i.classes),r},this.removeAllBeacons=()=>{document.querySelectorAll(`.${this.themeClasses.beacon}`).forEach((t=>t.remove())),window.usetiful_smartTipsObserver&&window.usetiful_smartTipsObserver.length>0&&window.usetiful_smartTipsObserver.forEach((t=>clearInterval(t)))},this.notifyUser=function(e,s,i,n,o,a){let l,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"bottom-right";const h=document.createElement("div");h.dataset.ufContent=e,h.setAttribute("style","display: none"),o&&h.classList.add(...o);const u=document.createElement("div");l=s instanceof HTMLElement?s:t.createTitle(3,s);const d=document.createElement("button");d.type="button",d.classList.add(t.themeClasses.buttonClose),d.dataset.ufButton="close";const p=()=>{a&&a(),ke(h)};if("checklist"===e&&(window.USETIFUL.checklist.close=p),d.addEventListener("click",p),d.innerHTML='<svg xmlns="http://www.w3.org/2000/svg"><path stroke="#000" stroke-width="2" d="M1 16L16 1M1 1l15 15"/></svg>',u.appendChild(d),l instanceof HTMLElement&&u.appendChild(l),i){const e=document.createElement("div");e.classList.add(t.themeClasses.content),e.innerHTML=i,u.appendChild(e)}if(n){const t=n();u.append(t)}h.appendChild(u),h.classList.add(t.themeClasses.notification),u.classList.add(`${t.themeClasses.notificationInner}`),"bottom-left"===c?(h.style.left="0",h.classList.add(t.themeClasses.left)):(h.style.right="0",h.classList.add(t.themeClasses.right)),h.style.bottom="0",t.isWatermark&&u.append(t.createWatermarkBadge()),document.body.appendChild(h),h.classList.contains(r.visible)||h.classList.add(r.visible)},this.confirmation=(t,e,s,i,n,o)=>{const a=`${r.prefix}-confirmation`,l=`.${a}`;document.querySelector(l)||this.notifyUser("confirm",t,e,(()=>{const t=this.createWrapper(this.themeClasses.actions);t.classList.add("center");const e=this.createLink(s);e.addEventListener("click",(t=>{n(),Le(l),t.preventDefault(),t.stopPropagation()}),!1),t.append(e);const r=this.createLink(i);return r.addEventListener("click",(t=>{Le(l),t.preventDefault(),t.stopPropagation()}),!1),t.append(r),t}),[a],(()=>{}),o)},this.showElement=t=>{document.body.appendChild(t),t.classList.contains(r.visible)||t.classList.add(r.visible)},this.changeItemToDoneStyle=t=>{const e=document.querySelector(`button[data-id='${t}']`);if(e instanceof HTMLButtonElement){e.classList.add(this.themeClasses.done),e.dataset.ufStatus="done";const t=e.querySelector(".svg-icon");t&&(t.innerHTML='<svg class="svg-icon filled" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M12 3.75a8.25 8.25 0 100 16.5 8.25 8.25 0 000-16.5zM2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12z"/><path clip-rule="evenodd" d="M16.465 8.411a.75.75 0 01.124 1.054l-4.404 5.577a1.25 1.25 0 01-1.827.145l-2.866-2.635a.75.75 0 111.016-1.104l2.667 2.453 4.236-5.366a.75.75 0 011.054-.124z"/></svg>')}},this.checklistProgressUpdate=()=>{var t;const e=document.querySelectorAll(`.${this.themeClasses.notificationInner} .${this.themeClasses.actions} button`);if(0===e.length)return;let s=0;e.forEach((t=>{t.classList.contains(this.themeClasses.done)&&(s+=1)}));const i=Math.round(s/(e.length/100));if(!i)return;null===(t=document.querySelector(`.${this.themeClasses.progressbar}`))||void 0===t||t.setAttribute("style",`width: ${i}%;`);const r=document.querySelector(`.${this.themeClasses.progressValue}`);r&&(r.textContent=`${i}%`)},this.destructElement=t=>{const e=we(`.${this.themeClasses.prefix}-${t}`);null==e||e.forEach((t=>{var e;null===(e=t.parentElement)||void 0===e||e.removeChild(t)}))},this.checkScrollableClass=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;const i=window.innerHeight;0===e.clientHeight&&s>=0&&setTimeout((()=>t.checkScrollableClass(e,s-1)),50),Jt&&e.clientHeight>.8*i?e.classList.add(t.themeClasses.scrollable):e.classList.remove(t.themeClasses.scrollable)},this.themeClasses=s(e),this.isWatermark=i}};const Ne=class{constructor(t){var e=this;this.setTheme=t=>{this.template.setTheme(t)},this.placeAllButtons=(t,e,s)=>{V("placeAllButtons called"),this.setAvailableTours(t);const i=[];for(let r=0;r<t.length;r+=1)t[r].tourData.button&&e(t[r].tourData,s)&&i.push(t[r]);if(1===i.length)this.placeUsetifulButton(i[0].tourData);else if(i.length>1){const t=[];i.forEach((e=>t.push(`\n${e.id} - ${e.name}`))),console.warn(`Usetiful: There are ${i.length} tours available on this page with usetiful button enabled: ${t.toString()} \n and we can't decide based on the targeting which button to display first.`)}},this.getButtonLabelContent=function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=`${t}`;return s&&s>0&&(i+=`<span class="${e.template.themeClasses.badge}">${s}</span>`),i},this.placeUsetifulButton=t=>{V("placeUsetifulButton called"),this.loadTourTheme(this.loader,t,(()=>{this.prepareMainButton(`tour_${t.id}`,t.buttonLabel,(()=>{window.USETIFUL.tour.start(t.id)}))}))},this.loadTourTheme=(t,e,s)=>{t&&e.theme&&t.loadTheme(e.theme,(()=>{this.setTheme(e.theme),s()}))},this.buttonContent="Usetiful Tour!",this.template=new Be,this.availableTours=[],this.loader=t}setButtonContent(t){this.buttonContent=t}getButtonContent(){return this.buttonContent}getButtonElement(){return document.querySelector('[data-uf-button="button-main"]')}setAvailableTours(t){this.availableTours=t}destroy(){ke(this.getButtonElement())}prepareMainButton(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(document.querySelector(`[data-uf-button="button-main"][data-uf-id="${t}"]`))return;V("prepareMainButton called"),this.destroy();let n=e;n||(n="Usetiful tours"),this.setButtonContent(n);const o=this.template.createLink(n,this.template.themeClasses.buttonMain);o.dataset.ufId=t,o.setAttribute("style","display:none"),s&&o.addEventListener("click",(t=>{s(),t.stopImmediatePropagation(),t.preventDefault()}),!1);const a=document.body;a&&a.appendChild(o),o.classList.add(r.visible),i&&"bottom-left"===i&&o.classList.add(this.template.themeClasses.buttonMainLeft)}};class Re{constructor(t,e){this.placeAppearsTrigger=()=>{let t=!1;return this.availableOnPage.checkTriggerURL(this.trigger)&&this.isInitial&&(t=this.setAppearTrigger()),t},this.setAppearTrigger=()=>{V(`setAppearTrigger called for ${this.elementSelector} ...`);const t=2*this.loop;let e=!1,s=1;if(!this.availableOnPage.checkTriggerURL(this.trigger))return!1;const i=window.setInterval((()=>{V(`${this.id}: ${s} / ${t}: Waiting on the element '${this.elementSelector}' to appear...`);const i=this.availableOnPage.checkElement(this.elementSelector)&&!Ie(Te(this.elementSelector));!e&&i&&this.triggerFunction?(V(`${this.id}: Element appeared`),e=!0,this.triggerFunction(),this.isInitial||this.removeAppearTrigger()):-1===this.loop||t&&s<t?s+=1:e?this.isInitial&&!i&&(e=!1,V(`${this.id}: Element disappeared`)):t&&(this.removeAppearTrigger(),this.failFunction?this.failFunction():this.altSolution&&this.altSolution())}),500);return this.intervalId=i,!0},this.removeAppearTrigger=()=>{V(`${this.id}: remoteAppearTrigger called.`),this.intervalId&&(clearInterval(this.intervalId),V(`${this.id}: interval removed.`))},this.trigger=t,this.id=(+new Date).toString(36),this.eventType=t.type,this.eventName=this.eventType,"custom"===this.eventType&&(this.eventName=t.name),this.loop=t.loop?parseInt(t.loop,10):0,this.url=t.url,this.elementSelector=t.element,this.isInitial=!1,this.isChecklistItem=!1,this.isProgressOnClick=!1,this.failFunction=void 0,this.triggerFunction=()=>{},this.reverseTriggerFunction=()=>{},this.availableOnPage=e}}const Ue=(t,e)=>e.checkTriggerURL(t),Me=t=>t.includes("#"),We=(t,e)=>{const s=ge(t);setTimeout((()=>{if(e){const t=window.open(s,"_blank");null==t||t.focus()}else window.location.href=s||"",Me(s)&&window.USETIFUL.reinitialize()}),1)},He=(t,e)=>!(!e.startsWith("/")&&!e.startsWith("."))||(t=new URL(t).hostname.replace("www.",""))===(e=new URL(e).hostname.replace("www.",""));class je{constructor(t){this.placeTrigger=t=>{if(V(`placeTrigger: Event ${t.eventName} on url: ${t.url} and element: ${t.elementSelector} with loop:${t.loop}.`),this.isTriggerMissing(t)){if("custom"===t.eventType){this.addToActiveTriggers(t);if(t.elementSelector&&Te(t.elementSelector)&&"window"!==t.elementSelector){const e=Te(t.elementSelector);e&&e.addEventListener(t.eventName,this.centralEventListener)}else this.placeCentralListener(t.eventName,t.elementSelector);return}switch(this.addToActiveTriggers(t),t.eventName){case"appears":t.placeAppearsTrigger()&&window.usetiful_intervals.push(t.intervalId);break;case"hover":{t.eventName="mouseover",this.placeCentralListener(t.eventName,t.elementSelector);const e=new Re(t.trigger,this.availableOnPage);e.eventName="mouseout",e.triggerFunction=t.reverseTriggerFunction,e.stepId=t.stepId,this.addToActiveTriggers(e),this.placeCentralListener(e.eventName,t.elementSelector);break}case"focus":t.eventName="focusin",this.placeCentralListener(t.eventName,t.elementSelector);break;case"mouseenter":t.eventName="mouseover",this.placeCentralListener(t.eventName,t.elementSelector);break;case"click":t.eventName="mouseup",this.placeCentralListener(t.eventName,t.elementSelector);break;default:this.placeCentralListener(t.eventName,t.elementSelector)}}},this.centralEventListener=t=>{const e=t.target||t.srcElement||t.currentTarget;if(V(`centralEventListener: called with event ${t.type} on element: ${e}`,!0),!(e instanceof Element||e instanceof HTMLElement||e instanceof Window))return;const s=this.searchInActiveTriggers(t.type,e);G(e),s.forEach((e=>{e.stepId?e.triggerFunction(e.stepId):e.isChecklistItem&&e.checklistItemId?e.triggerFunction(e.checklistItemId):e.triggerFunction(t)}))},this.updateListeners=()=>{V("Updating listeners on window.usetiful_activeTriggersOnElements..."),window.usetiful_activeListeners&&window.usetiful_activeListeners.forEach((t=>{window.removeEventListener(t,this.centralEventListener)})),window.usetiful_activeListeners=[],window.usetiful_activeTriggersOnElements.forEach((t=>{this.placeCentralListener(t.eventName,t.elementSelector)}))},this.placeCentralListener=(t,e)=>{var s,i;const r=Se(e||""),n=`${t}(${r.isAShadowDomSelector?r.shadowDomSelector:"window"})`;t&&window.usetiful_activeListeners&&-1===window.usetiful_activeListeners.indexOf(n)&&(window.usetiful_activeListeners.push(n),r.isAShadowDomSelector&&r.shadowDomSelector?null===(i=null===(s=document.querySelector(r.shadowDomSelector))||void 0===s?void 0:s.shadowRoot)||void 0===i||i.addEventListener(t,this.centralEventListener):window.addEventListener(t,this.centralEventListener))},this.removeCentralListener=t=>{if(!window.usetiful_activeListeners)return;const e=window.usetiful_activeListeners.indexOf(t);e>-1&&window.usetiful_activeListeners.splice(e,1)},this.hasProgressOnClickTrigger=t=>{const e=this.searchInActiveTriggers("mouseup",t);for(let t=0;t<e.length;t+=1)if(e[t].isProgressOnClick)return!0;return!1},this.isTriggerMissing=t=>{const e=this.searchInActiveTriggers(t.eventName,t.elementSelector);let s=!1;return e.forEach((e=>{e.isChecklistItem===t.isChecklistItem&&e.isProgressOnClick===t.isProgressOnClick&&e.isInitial===t.isInitial&&(s=!0)})),!s},this.searchInActiveTriggers=(t,e)=>{const s=window.usetiful_activeTriggersOnElements,i=e,r=[];for(let e=0;e<s.length;e+=1){const n="hover"===t||"focus"===t||"mouseenter"===t||"click"===t?s[e].eventType===t:s[e].eventName===t;if(Ue(s[e],this.availableOnPage)&&n){const n=s[e].elementSelector;let o=!1;if("string"==typeof i)o=n===i;else{const e=!n||"window"===n;(e?window:Te(n))===i?o=!0:!i||i instanceof Window||e||"click"!==t&&"mouseup"!==t&&"wheel"!==t&&"mouseover"!==t||(o=Ee(i,n),!o&&Ce(i,"a")&&(o=i&&null!==i.querySelector(n)))}o&&r.push(s[e])}}return r},this.addToActiveTriggers=t=>{t&&t.eventName&&window.usetiful_activeTriggersOnElements.push(t)},this.removeFromActiveTriggers=t=>{const e=window.usetiful_activeTriggersOnElements.indexOf(t);V(`removing item on index ${e} from active triggers`),window.usetiful_activeTriggersOnElements.splice(e,1)},this.removeAllTriggers=t=>{V("removeAllTriggers called");[...window.usetiful_activeTriggersOnElements].forEach(((e,s)=>{if(!t&&e.isInitial&&e.isChecklistItem)return;if(V(`item ${s}...`),"custom"===e.eventType){if(this.removeFromActiveTriggers(e),window.removeEventListener(e.eventName,this.centralEventListener),e.elementSelector&&"window"!==e.elementSelector){const t=document.querySelector(e.elementSelector);t&&t.removeEventListener(e.eventName,this.centralEventListener)}return}"appears"===e.eventName?(this.removeFromActiveTriggers(e),e.removeAppearTrigger()):this.removeFromActiveTriggers(e)})),this.updateListeners()},this.triggersClearance=t=>{V("triggersClearance: Removing triggers from window.usetiful_activeTriggersOnElements..."),window.usetiful_activeTriggersOnElements.length>0&&(this.removeAllTriggers(t),t&&window.usetiful_activeTriggersOnElements.length>0&&K("triggersClearance: No all active triggers were removed"))},window.usetiful_activeTriggersOnElements||(window.usetiful_activeTriggersOnElements=[]),window.usetiful_activeListeners||(window.usetiful_activeListeners=[]),this.availableOnPage=t}}const Fe="address-simple",_e="address-not-contain",qe="address-exact",ze="address",Je="element",Ve="not-element",Ke="element-text",Ge="element-attr",Xe="all-types",Ye="desktop",Qe="mobile",Ze="tablet",ts="target-device",es="tag-is-not",ss="tag-contain",is="tag-not-contain",rs="tag-lower",ns="tag-higher",os="audience-language",as="device-ls-data",ls="device-tour-finished",cs=[{value:Xe,label:"All types"},{value:Ye,label:"Desktop"},{value:Qe,label:"Mobile"},{value:Ze,label:"Tablet"}],hs=[{value:"tag-exact",label:"is"},{value:es,label:"is not"},{value:ss,label:"contains"},{value:is,label:"doesn't contain"},{value:rs,label:"lower than"},{value:ns,label:"higher than"}],us="audience-browser",ds="all-browsers",ps="chrome",gs="firefox",ms="edge",fs="safari",vs="opera",Ts="blink",ws=[{value:ds,label:"Any browser"},{value:ps,label:"Google Chrome"},{value:gs,label:"Firefox"},{value:"ie",label:"Internet Explorer"},{value:ms,label:"Microsoft Edge"},{value:fs,label:"Safari"},{value:vs,label:"Opera"},{value:Ts,label:"Blink"}],bs="audience-os",Ss="all-systems",ys="windows",Cs="macos",ks="android",Ls="linux",Es=[{value:Ss,label:"Any operating system"},{value:ys,label:"Windows"},{value:Cs,label:"macOS"},{value:"ios",label:"iOS"},{value:ks,label:"Android"},{value:Ls,label:"Linux"}],Is="page-conditions",Ds="page-element-consitions",xs="audience-conditions",As="device-conditions",Ps="referrer-exact",$s="referrer-contains",Os={element:"Element selector"},Bs=(Object.assign({},Os),Object.assign({},Os),Object.assign(Object.assign({},Os),{text:"Text content"}),Object.assign(Object.assign({},Os),{attr:"Attribute name",text:"Text content"}),["Win32","Win64","Windows","WinCE"].indexOf(window.navigator.platform)>-1),Ns=["Macintosh","MacIntel","MacPPC","Mac68K"].indexOf(window.navigator.platform)>-1,Rs=["iPhone","iPad","iPod"].indexOf(window.navigator.platform)>-1,Us=/Android/.test(window.navigator.userAgent),Ms=/Linux/.test(window.navigator.platform);class Ws{constructor(t){var e=this;this.getWildcardCharacter=()=>this.wildcard,this.containWildcard=t=>t.indexOf(this.wildcard)>-1,this.getWildcardIndexes=function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.wildcard;const i=[];let r=t.indexOf(s,0);for(;r>=0;)i.push(r),r=t.indexOf(s,r+1);return i},this.checkWildcardURLExact=(t,e)=>{if(""===t.replace(new RegExp(this.wildcard,"g"),""))return!0;const s=t.split(this.getWildcardCharacter()),i=this.getWildcardIndexes(t),r=t.indexOf(s[0])>i[0]||s[0]===t.substring(0,i[0]),n=t.indexOf(s[s.length-1])<i[0]||s[s.length-1]===t.substring(i[i.length-1]+this.wildcard.length);return this.checkWildcardURLContains(t,e)&&r&&n},this.checkWildcardURLContains=(t,e)=>{const s=t.split(this.getWildcardCharacter());if(s.length>2){const t=[];for(let i=0;i<s.length-1;i++){const r=`${s[i]}${this.getWildcardCharacter()}${s[i+1]}`;t.push(this.checkWildcardStringContains(r,e))}return!t.includes(!1)}return this.checkWildcardStringContains(t,e)},this.checkWildcardStringContains=(t,e)=>{if(""===t.replace(new RegExp(this.wildcard,"g"),""))return!0;const s=t.indexOf(this.wildcard),i=t.substring(0,s),r=t.substring(s+this.wildcard.length),n=e.indexOf(i),o=e.indexOf(r);return!(i.length>0&&-1===n||r.length>0&&-1===o||i&&r&&n+i.length>o)},this.wildcard=t}}class Hs{constructor(t){var e=this;this.checkIfInputContainWildcard=t=>this.wildcard.containWildcard(t),this.checkWildcardURLExact=t=>this.wildcard.checkWildcardURLExact(t,this.location),this.checkWildcardURLContains=t=>this.wildcard.checkWildcardURLContains(t,this.location),this.checkURL=t=>{if(this.checkIfInputContainWildcard(t))return this.checkWildcardURLExact(t);try{return new RegExp(t,"i").test(this.location)}catch(e){return console.warn(`Entered regular expression'${t}' isn't valid.`),!1}},this.checkURLSimple=t=>this.checkIfInputContainWildcard(t)?this.checkWildcardURLContains(t):this.location.indexOf(t)>-1,this.checkURLNotContain=t=>this.checkIfInputContainWildcard(t)?!this.checkWildcardURLContains(t):-1===this.location.indexOf(t),this.checkURLExact=t=>this.checkIfInputContainWildcard(t)?this.checkWildcardURLExact(t):this.location===t,this.checkTag=(t,e,s)=>{var i,r;if(!window.usetifulTags||void 0===(null===(i=window.usetifulTags)||void 0===i?void 0:i[t]))return!1;const n=null===(r=window.usetifulTags)||void 0===r?void 0:r[t];switch(s){case es:return n!==e;case ss:return n.indexOf(e)>=0;case is:return-1===n.indexOf(e);case ns:return"number"==typeof n?n>parseInt(e,10):parseInt(n,10)>parseInt(e,10);case rs:return"number"==typeof n?n<parseInt(e,10):parseInt(n,10)<parseInt(e,10);default:return n===e}},this.refreshURL=()=>{this.location=window.location.href},this.checkElement=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(ve(t)){const s=Te(t);if(s)return!e||!s.textContent||new RegExp(e).test(s.textContent.trim())}return!1},this.checkAttribute=(t,e,s)=>{if(ve(t)){const i=Te(t);if(i){const t=i.getAttribute(e);return!(!t||!s)&&new RegExp(s).test(t.trim())}}return!1},this.checkTriggerURL=t=>!!t&&(!t.url||""!==t.url&&this.checkURL(t.url)),this.checkDevice=t=>{let e=!1;switch(t){case Xe:e=!0;break;case Ye:e=Kt;break;case Qe:e=Jt;break;case Ze:e=Vt}return e},this.checkBrowser=t=>{let e=!1;switch(t){case ds:e=!0;break;case ps:e=_t;break;case gs:e=Wt;break;case fs:e=Ht;break;case vs:e=Mt;break;case"ie":e=jt;break;case ms:e=Ft;break;case Ts:e=qt}return e},this.checkOS=t=>{let e=!1;switch(t){case Ss:e=!0;break;case ys:e=Bs;break;case Cs:e=Ns;break;case"ios":e=Rs;break;case ks:e=Us;break;case Ls:e=Ms}return e},this.checkTargetEntity=(t,e,s,i)=>{if(t[e])return!0;const r=[];return Object.keys(t).forEach((e=>{t[e]&&r.push(s(e))})),i?r.every((t=>t)):r.some((t=>t))},this.checkBrowserLanguage=t=>window.navigator&&window.navigator.language.indexOf(t)>-1,this.checkLS=(t,e)=>localStorage.getItem(t)===e,this.checkTourState=(t,e)=>{const s="state",i=this.api.getStoredObjectData(t);return i&&i[s]?i[s]===e:e===c},this.checkReferrerURL=(t,e)=>e?document.referrer===t:document.referrer.indexOf(t)>-1,this.evaluate=(t,e,s)=>t?e&&s:e||s,this.checkByTargets=(t,e)=>{let s=!1;const i=!e||0===e;let r=!1,n=!1,o=!1;const a={},l={},c={};return!t||0===t.length||(Array.isArray(t)&&(i&&(s=!0),t.forEach((t=>{var e,h,u;switch(t.type){case qe:s=this.evaluate(i,s,this.checkURLExact(t.url));break;case Fe:s=this.evaluate(i,s,this.checkURLSimple(t.url));break;case _e:s=this.evaluate(i,s,this.checkURLNotContain(t.url));break;case ze:s=this.evaluate(i,s,this.checkURL(t.url));break;case"tag":s=this.evaluate(i,s,this.checkTag(t.name,t.text,t.operator));break;case Je:s=this.evaluate(i,s,this.checkElement(t.element));break;case Ve:s=this.evaluate(i,s,!this.checkElement(t.element));break;case Ke:s=this.evaluate(i,s,this.checkElement(t.element,t.text));break;case Ge:s=this.evaluate(i,s,this.checkAttribute(t.element,t.attr,t.text));break;case ts:(null===(e=t.device)||void 0===e?void 0:e.length)>0&&(r=!0,a[t.device]=!0);break;case us:(null===(h=t.browser)||void 0===h?void 0:h.length)>0&&(n=!0,l[t.browser]=!0);break;case bs:(null===(u=t.os)||void 0===u?void 0:u.length)>0&&(o=!0,c[t.os]=!0);break;case os:s=this.evaluate(i,s,this.checkBrowserLanguage(t.text));break;case as:s=this.evaluate(i,s,this.checkLS(t.name,t.text));break;case ls:s=this.evaluate(i,s,this.checkTourState(t.tours,t.state));break;case Ps:s=this.evaluate(i,s,this.checkReferrerURL(t.url,!0));break;case $s:s=this.evaluate(i,s,this.checkReferrerURL(t.url,!1))}})),r&&(s=this.evaluate(i,s,this.checkTargetEntity(a,Xe,this.checkDevice,i))),n&&(s=this.evaluate(i,s,this.checkTargetEntity(l,ds,this.checkBrowser,i))),o&&(s=this.evaluate(i,s,this.checkTargetEntity(c,Ss,this.checkOS,i)))),s)},this.checkTargetWithWaiting=function(t,s){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:60;return new Promise(((r,n)=>{let o=0;const a=setInterval((()=>{o+=1,e.checkAvailableOnPage(t,s)&&(r(null),clearInterval(a)),o>=i&&(clearInterval(a),n())}),500)}))},this.getParsedConditions=t=>{let e=t;try{return!t||t instanceof Object||(e=JSON.parse(t)),e}catch(t){V("Targets field is not JSON.")}return!1},this.location=window.location.href,this.wildcard=new Ws("{}"),this.api=t}checkAvailableOnPage(t,e){const s=this.getParsedConditions(t);let i=s,r=[];s&&(i=s.filter((t=>!Object.keys(t).includes("targets"))),r=s.filter((t=>Object.keys(t).includes("targets"))));let n=this.checkByTargets(i,e);r.length>0&&(!i||0===i.length)&&(n=1!==e);const o=[n];return r&&r.forEach((t=>{o.push(this.checkByTargets(t.targets,t.targetOperator))})),e?o.some((t=>t)):o.every((t=>t))}}const js=["uf_progressorLastSaveSuccessful"];const Fs=class{constructor(t){this.keysToRemove=js,this.toursData=[],this.api=t}init(t){this.toursData=t,this.permanentlyRemoveFromLS(),this.restartTours(),this.api.saveToLocalStorage(this.api.getStoredData())}permanentlyRemoveFromLS(){this.keysToRemove.forEach((t=>{localStorage.removeItem(t)}))}restartTours(){this.toursData.filter((t=>{const e=this.api.getStoredObjectData(t.id.toString()),s=t.lastRestartOn,i=null==e?void 0:e.updatedAt;return i&&s&&s>i||s&&!i?t:null})).map((t=>this.api.removeObject(t.id.toString())))}},_s="tour",qs="smart-tips-group";const zs=class{constructor(t,e,s){var i=this;this.isGivenObject=(t,e)=>{var s;return(null==t?void 0:t.name)===e||t.id===e||(null===(s=null==t?void 0:t.id)||void 0===s?void 0:s.toString())===e},this.setProgressToLocalStorage=(t,e,s)=>{const{name:i,id:r}=e,n=(new Date).toISOString();this.type===_s?(this.updateState(r,{state:t,name:i,currentStep:s||0,updatedAt:n}),this.updatePreviewStep(t,s||0)):this.updateState(r,{state:t,id:r,updatedAt:n})},this.getCurrentStepIndexLS=t=>this.getObjectState(t.toString(),"currentStep",0),this.closeTourInLS=(t,e)=>{this.setProgressToLocalStorage(l,{name:e,id:t},0)},this.closeInProgressTour=(t,e)=>{this.getObjectState(t.toString(),"state")===a&&this.closeTourInLS(t.toString(),e)},this.removeObject=t=>{let e=this.getStoredData();e=e.filter((e=>!this.isGivenObject(e,t))).map((t=>t)),this.progressor&&this.saveToStorage(e),this.saveToLocalStorage(e)},this.removeDuplicities=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.getStoredData();if(t&&t.length){const e=[];return t.forEach((t=>{const s=e.find((e=>e.id&&t.id&&e.id.toString()===t.id.toString()));if(s){if(!s.updatedAt||t.updatedAt>s.updatedAt){const s=e.findIndex((e=>{var s,i;return(null===(s=e.id)||void 0===s?void 0:s.toString())===(null===(i=t.id)||void 0===i?void 0:i.toString())}));e[s]=t}}else e.push(t)})),e}return[]},this.type=t,this.loadedFromStorage=!1,this.progressorAPI=s,this.progressor=t===_s?this.progressorAPI:null,this.storageKeyName=e}getStoredData(){if(this.progressor&&!this.loadedFromStorage){const t=this.progressor.getUserData(this.storageKeyName);if(this.loadedFromStorage=!0,t&&"string"==typeof t){const e=JSON.parse(t);return this.saveToLocalStorage(e),e}}let t=[];const e=window.localStorage.getItem(this.storageKeyName);return e&&(t=JSON.parse(e)),t}getStoredObjectData(t){const e=this.getStoredData();let s=null;return e&&e.length&&(s=e.find((e=>this.isGivenObject(e,t)))||null),s}getObjectState(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=this.getStoredObjectData(t);return i&&i[e]?i[e]:s}setStateByProperty(t,e,s){const i=this.getStoredData().map((i=>this.isGivenObject(i,t)?Object.assign(Object.assign({},i),{[e]:s}):i));this.saveToLocalStorage(i)}updateState(t,e){let s=this.getStoredData();null===this.getStoredObjectData(t)&&(this.type===_s?s.push(Object.assign({id:t},e)):this.type===qs&&s.push(Object.assign({},e))),s=s.map((s=>this.isGivenObject(s,t)?Object.assign(Object.assign({},s),e):s)),this.progressor&&this.saveToStorage(s),this.saveToLocalStorage(s)}saveToLocalStorage(t){window.localStorage.setItem(this.storageKeyName,JSON.stringify(this.removeDuplicities(t)))}saveToStorage(t){this.progressorAPI.saveUserData(this.storageKeyName,JSON.stringify(t))}getObjectStatus(t){return this.getObjectState(t,"state")}updatePreviewStep(t,e){let s=e;t===l&&(s=-1),window.dispatchEvent(new CustomEvent("updatePreviewStep",{detail:s}))}isAnyTourRunning(t){const e=this.getStoredData();if(e&&e.length)for(const[s,i]of Object.entries(e)){const e=i.id;if(e&&s&&i&&i.state===a&&t.find((t=>t.id===e)))return e}return null}isTourReopenFromLS(t){return this.getObjectStatus(t)===l}},Js="BeforeUnload",Vs="SpaceApi",Ks="ReporterApi",Gs="Report",Xs="TourTriggersControl",Ys="CommonTriggersControl",Qs="Loader",Zs="ProgressorApi",ti="UsetifulTags",ei="Dismiss",si="ButtonControl",ii="AvailableOnPage",ri="LocalStorageCleaner",ni="StorageApiTour",oi="StorageApiSmartTips",ai={LocalStorage:"LocalStorage",apiToken:"apiToken",isPluginScript:"isPluginScript",reporterBasePath:"reporterBasePath",license:"license",watermark:"watermark",assistantInstance:"assistantInstance",checklistInstance:"checklistInstance",toursInstance:"toursInstance",tourType:_s,smartTipsType:qs,tourStorageKeyName:q,smartTipsGroupStorageKeyName:z},li=new et,ci=t=>li.get(t),hi=(t,e)=>li.registerConstant(t,e);function ui(t){return t.split("-")[0]}function di(t){return t.split("-")[1]}function pi(t){return["top","bottom"].includes(ui(t))?"x":"y"}function gi(t){return"y"===t?"height":"width"}function mi(t,e,s){let{reference:i,floating:r}=t;const n=i.x+i.width/2-r.width/2,o=i.y+i.height/2-r.height/2,a=pi(e),l=gi(a),c=i[l]/2-r[l]/2,h="x"===a;let u;switch(ui(e)){case"top":u={x:n,y:i.y-r.height};break;case"bottom":u={x:n,y:i.y+i.height};break;case"right":u={x:i.x+i.width,y:o};break;case"left":u={x:i.x-r.width,y:o};break;default:u={x:i.x,y:i.y}}switch(di(e)){case"start":u[a]-=c*(s&&h?-1:1);break;case"end":u[a]+=c*(s&&h?-1:1)}return u}function fi(t){return"number"!=typeof t?function(t){return{top:0,right:0,bottom:0,left:0,...t}}(t):{top:t,right:t,bottom:t,left:t}}function vi(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}async function Ti(t,e){var s;void 0===e&&(e={});const{x:i,y:r,platform:n,rects:o,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:h="viewport",elementContext:u="floating",altBoundary:d=!1,padding:p=0}=e,g=fi(p),m=a[d?"floating"===u?"reference":"floating":u],f=vi(await n.getClippingRect({element:null==(s=await(null==n.isElement?void 0:n.isElement(m)))||s?m:m.contextElement||await(null==n.getDocumentElement?void 0:n.getDocumentElement(a.floating)),boundary:c,rootBoundary:h,strategy:l})),v=vi(n.convertOffsetParentRelativeRectToViewportRelativeRect?await n.convertOffsetParentRelativeRectToViewportRelativeRect({rect:"floating"===u?{...o.floating,x:i,y:r}:o.reference,offsetParent:await(null==n.getOffsetParent?void 0:n.getOffsetParent(a.floating)),strategy:l}):o[u]);return{top:f.top-v.top+g.top,bottom:v.bottom-f.bottom+g.bottom,left:f.left-v.left+g.left,right:v.right-f.right+g.right}}const wi=Math.min,bi=Math.max;function Si(t,e,s){return bi(t,wi(e,s))}const yi={left:"right",right:"left",bottom:"top",top:"bottom"};function Ci(t){return t.replace(/left|right|bottom|top/g,(t=>yi[t]))}function ki(t,e,s){void 0===s&&(s=!1);const i=di(t),r=pi(t),n=gi(r);let o="x"===r?i===(s?"end":"start")?"right":"left":"start"===i?"bottom":"top";return e.reference[n]>e.floating[n]&&(o=Ci(o)),{main:o,cross:Ci(o)}}const Li={start:"end",end:"start"};function Ei(t){return t.replace(/start|end/g,(t=>Li[t]))}const Ii=["top","right","bottom","left"],Di=Ii.reduce(((t,e)=>t.concat(e,e+"-start",e+"-end")),[]);const xi=function(t){return void 0===t&&(t=0),{name:"offset",options:t,async fn(e){const{x:s,y:i}=e,r=await async function(t,e){const{placement:s,platform:i,elements:r}=t,n=await(null==i.isRTL?void 0:i.isRTL(r.floating)),o=ui(s),a=di(s),l="x"===pi(s),c=["left","top"].includes(o)?-1:1,h=n&&l?-1:1,u="function"==typeof e?e(t):e;let{mainAxis:d,crossAxis:p,alignmentAxis:g}="number"==typeof u?{mainAxis:u,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...u};return a&&"number"==typeof g&&(p="end"===a?-1*g:g),l?{x:p*h,y:d*c}:{x:d*c,y:p*h}}(e,t);return{x:s+r.x,y:i+r.y,data:r}}}};function Ai(t){return"x"===t?"y":"x"}const Pi=function(t){return void 0===t&&(t={}),{name:"shift",options:t,async fn(e){const{x:s,y:i,placement:r}=e,{mainAxis:n=!0,crossAxis:o=!1,limiter:a={fn:t=>{let{x:e,y:s}=t;return{x:e,y:s}}},...l}=t,c={x:s,y:i},h=await Ti(e,l),u=pi(ui(r)),d=Ai(u);let p=c[u],g=c[d];if(n){const t="y"===u?"bottom":"right";p=Si(p+h["y"===u?"top":"left"],p,p-h[t])}if(o){const t="y"===d?"bottom":"right";g=Si(g+h["y"===d?"top":"left"],g,g-h[t])}const m=a.fn({...e,[u]:p,[d]:g});return{...m,data:{x:m.x-s,y:m.y-i}}}}};function $i(t){return t&&t.document&&t.location&&t.alert&&t.setInterval}function Oi(t){if(null==t)return window;if(!$i(t)){const e=t.ownerDocument;return e&&e.defaultView||window}return t}function Bi(t){return Oi(t).getComputedStyle(t)}function Ni(t){return $i(t)?"":t?(t.nodeName||"").toLowerCase():""}function Ri(){const t=navigator.userAgentData;return null!=t&&t.brands?t.brands.map((t=>t.brand+"/"+t.version)).join(" "):navigator.userAgent}function Ui(t){return t instanceof Oi(t).HTMLElement}function Mi(t){return t instanceof Oi(t).Element}function Wi(t){return"undefined"!=typeof ShadowRoot&&(t instanceof Oi(t).ShadowRoot||t instanceof ShadowRoot)}function Hi(t){const{overflow:e,overflowX:s,overflowY:i}=Bi(t);return/auto|scroll|overlay|hidden/.test(e+i+s)}function ji(t){return["table","td","th"].includes(Ni(t))}function Fi(t){const e=/firefox/i.test(Ri()),s=Bi(t);return"none"!==s.transform||"none"!==s.perspective||"paint"===s.contain||["transform","perspective"].includes(s.willChange)||e&&"filter"===s.willChange||e&&!!s.filter&&"none"!==s.filter}function _i(){return!/^((?!chrome|android).)*safari/i.test(Ri())}const qi=Math.min,zi=Math.max,Ji=Math.round;function Vi(t,e,s){var i,r,n,o;void 0===e&&(e=!1),void 0===s&&(s=!1);const a=t.getBoundingClientRect();let l=1,c=1;e&&Ui(t)&&(l=t.offsetWidth>0&&Ji(a.width)/t.offsetWidth||1,c=t.offsetHeight>0&&Ji(a.height)/t.offsetHeight||1);const h=Mi(t)?Oi(t):window,u=!_i()&&s,d=(a.left+(u&&null!=(i=null==(r=h.visualViewport)?void 0:r.offsetLeft)?i:0))/l,p=(a.top+(u&&null!=(n=null==(o=h.visualViewport)?void 0:o.offsetTop)?n:0))/c,g=a.width/l,m=a.height/c;return{width:g,height:m,top:p,right:d+g,bottom:p+m,left:d,x:d,y:p}}function Ki(t){return(e=t,(e instanceof Oi(e).Node?t.ownerDocument:t.document)||window.document).documentElement;var e}function Gi(t){return Mi(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function Xi(t){return Vi(Ki(t)).left+Gi(t).scrollLeft}function Yi(t,e,s){const i=Ui(e),r=Ki(e),n=Vi(t,i&&function(t){const e=Vi(t);return Ji(e.width)!==t.offsetWidth||Ji(e.height)!==t.offsetHeight}(e),"fixed"===s);let o={scrollLeft:0,scrollTop:0};const a={x:0,y:0};if(i||!i&&"fixed"!==s)if(("body"!==Ni(e)||Hi(r))&&(o=Gi(e)),Ui(e)){const t=Vi(e,!0);a.x=t.x+e.clientLeft,a.y=t.y+e.clientTop}else r&&(a.x=Xi(r));return{x:n.left+o.scrollLeft-a.x,y:n.top+o.scrollTop-a.y,width:n.width,height:n.height}}function Qi(t){return"html"===Ni(t)?t:t.assignedSlot||t.parentNode||(Wi(t)?t.host:null)||Ki(t)}function Zi(t){return Ui(t)&&"fixed"!==getComputedStyle(t).position?t.offsetParent:null}function tr(t){const e=Oi(t);let s=Zi(t);for(;s&&ji(s)&&"static"===getComputedStyle(s).position;)s=Zi(s);return s&&("html"===Ni(s)||"body"===Ni(s)&&"static"===getComputedStyle(s).position&&!Fi(s))?e:s||function(t){let e=Qi(t);for(Wi(e)&&(e=e.host);Ui(e)&&!["html","body"].includes(Ni(e));){if(Fi(e))return e;e=e.parentNode}return null}(t)||e}function er(t){if(Ui(t))return{width:t.offsetWidth,height:t.offsetHeight};const e=Vi(t);return{width:e.width,height:e.height}}function sr(t){const e=Qi(t);return["html","body","#document"].includes(Ni(e))?t.ownerDocument.body:Ui(e)&&Hi(e)?e:sr(e)}function ir(t,e){var s;void 0===e&&(e=[]);const i=sr(t),r=i===(null==(s=t.ownerDocument)?void 0:s.body),n=Oi(i),o=r?[n].concat(n.visualViewport||[],Hi(i)?i:[]):i,a=e.concat(o);return r?a:a.concat(ir(o))}function rr(t,e,s){return"viewport"===e?vi(function(t,e){const s=Oi(t),i=Ki(t),r=s.visualViewport;let n=i.clientWidth,o=i.clientHeight,a=0,l=0;if(r){n=r.width,o=r.height;const t=_i();(t||!t&&"fixed"===e)&&(a=r.offsetLeft,l=r.offsetTop)}return{width:n,height:o,x:a,y:l}}(t,s)):Mi(e)?function(t,e){const s=Vi(t,!1,"fixed"===e),i=s.top+t.clientTop,r=s.left+t.clientLeft;return{top:i,left:r,x:r,y:i,right:r+t.clientWidth,bottom:i+t.clientHeight,width:t.clientWidth,height:t.clientHeight}}(e,s):vi(function(t){var e;const s=Ki(t),i=Gi(t),r=null==(e=t.ownerDocument)?void 0:e.body,n=zi(s.scrollWidth,s.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),o=zi(s.scrollHeight,s.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0);let a=-i.scrollLeft+Xi(t);const l=-i.scrollTop;return"rtl"===Bi(r||s).direction&&(a+=zi(s.clientWidth,r?r.clientWidth:0)-n),{width:n,height:o,x:a,y:l}}(Ki(t)))}function nr(t){const e=ir(t),s=["absolute","fixed"].includes(Bi(t).position)&&Ui(t)?tr(t):t;return Mi(s)?e.filter((t=>Mi(t)&&function(t,e){const s=null==e.getRootNode?void 0:e.getRootNode();if(t.contains(e))return!0;if(s&&Wi(s)){let s=e;do{if(s&&t===s)return!0;s=s.parentNode||s.host}while(s)}return!1}(t,s)&&"body"!==Ni(t))):[]}const or={getClippingRect:function(t){let{element:e,boundary:s,rootBoundary:i,strategy:r}=t;const n=[..."clippingAncestors"===s?nr(e):[].concat(s),i],o=n[0],a=n.reduce(((t,s)=>{const i=rr(e,s,r);return t.top=zi(i.top,t.top),t.right=qi(i.right,t.right),t.bottom=qi(i.bottom,t.bottom),t.left=zi(i.left,t.left),t}),rr(e,o,r));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(t){let{rect:e,offsetParent:s,strategy:i}=t;const r=Ui(s),n=Ki(s);if(s===n)return e;let o={scrollLeft:0,scrollTop:0};const a={x:0,y:0};if((r||!r&&"fixed"!==i)&&(("body"!==Ni(s)||Hi(n))&&(o=Gi(s)),Ui(s))){const t=Vi(s,!0);a.x=t.x+s.clientLeft,a.y=t.y+s.clientTop}return{...e,x:e.x-o.scrollLeft+a.x,y:e.y-o.scrollTop+a.y}},isElement:Mi,getDimensions:er,getOffsetParent:tr,getDocumentElement:Ki,getElementRects:t=>{let{reference:e,floating:s,strategy:i}=t;return{reference:Yi(e,tr(s),i),floating:{...er(s),x:0,y:0}}},getClientRects:t=>Array.from(t.getClientRects()),isRTL:t=>"rtl"===Bi(t).direction};function ar(t,e,s,i){void 0===i&&(i={});const{ancestorScroll:r=!0,ancestorResize:n=!0,elementResize:o=!0,animationFrame:a=!1}=i,l=r&&!a,c=n&&!a,h=l||c?[...Mi(t)?ir(t):[],...ir(e)]:[];h.forEach((t=>{l&&t.addEventListener("scroll",s,{passive:!0}),c&&t.addEventListener("resize",s)}));let u,d=null;if(o){let i=!0;d=new ResizeObserver((()=>{i||s(),i=!1})),Mi(t)&&!a&&d.observe(t),d.observe(e)}let p=a?Vi(t):null;return a&&function e(){const i=Vi(t);!p||i.x===p.x&&i.y===p.y&&i.width===p.width&&i.height===p.height||s(),p=i,u=requestAnimationFrame(e)}(),s(),()=>{var t;h.forEach((t=>{l&&t.removeEventListener("scroll",s),c&&t.removeEventListener("resize",s)})),null==(t=d)||t.disconnect(),d=null,a&&cancelAnimationFrame(u)}}const lr=(t,e,s)=>(async(t,e,s)=>{const{placement:i="bottom",strategy:r="absolute",middleware:n=[],platform:o}=s,a=await(null==o.isRTL?void 0:o.isRTL(e));let l=await o.getElementRects({reference:t,floating:e,strategy:r}),{x:c,y:h}=mi(l,i,a),u=i,d={},p=0;for(let s=0;s<n.length;s++){const{name:g,fn:m}=n[s],{x:f,y:v,data:T,reset:w}=await m({x:c,y:h,initialPlacement:i,placement:u,strategy:r,middlewareData:d,rects:l,platform:o,elements:{reference:t,floating:e}});c=null!=f?f:c,h=null!=v?v:h,d={...d,[g]:{...d[g],...T}},w&&p<=50&&(p++,"object"==typeof w&&(w.placement&&(u=w.placement),w.rects&&(l=!0===w.rects?await o.getElementRects({reference:t,floating:e,strategy:r}):w.rects),({x:c,y:h}=mi(l,u,a))),s=-1)}return{x:c,y:h,placement:u,strategy:r,middlewareData:d}})(t,e,{platform:or,...s}),cr=()=>{(t=>{const e=document.querySelectorAll(`.${r.overlay}`);e&&Array.prototype.forEach.call(e,(e=>{e.classList.remove(t)}))})(r.visible)},hr=()=>{(t=>{const e=document.querySelectorAll(`.${r.overlay}`);e&&Array.prototype.forEach.call(e,(e=>{e.classList.add(t)}))})(r.visible)},ur=()=>{const t=document.querySelectorAll(`.${r.overlay}`);t&&Array.prototype.forEach.call(t,(t=>{t.parentNode.removeChild(t)}))};function dr(t){t.setAttribute("data-show","")}function pr(t,e){if(t.removeAttribute("data-show"),e){const t=document.getElementById(e);null==t||t.classList.remove("max-zindex")}const s=new CustomEvent(k.tipHidden,{detail:{bubbleId:t.getAttribute("id")}});document.dispatchEvent(s)}const gr=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"absolute";const e=(()=>{const t={};return["right","left","top","bottom"].forEach((e=>{let s=document.querySelector(`.${r.overlay}.${r[e]}`);s||(s=document.createElement("div"),s.classList.add(r.overlay,r[e]),document.body.appendChild(s)),t[e]=s})),t})();return Object.values(e).forEach((e=>{e.style.position=t})),hr(),e},mr=t=>({name:"backdrop",options:t,fn(e){var s,i;if(t)if(null===(i=null===(s=e.modifiersData)||void 0===s?void 0:s.hide)||void 0===i?void 0:i.isReferenceHidden)cr();else{const{x:s,y:i,width:r,height:n}=e.rects.reference;!function(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;const{top:r,left:n,right:o,bottom:a}=t,{x:l,y:c,width:h,height:u}=e||{x:0,y:0,width:0,height:0},{max:d,min:p,floor:g}=Math,{clientHeight:m,scrollHeight:f,clientWidth:v,scrollWidth:T}=document.body,{innerHeight:w,innerWidth:b}=window,S="fixed"===s?w-1:d(w,m,f),y="fixed"===s?b-1:d(v,T,b),C=g(d(l-i,0)),k=g(d(c-i,0)),L=g(p(l+i+h,y)),E=g(p(c+i+u,S));n.style.width=`${C}px`,n.style.height=`${S}px`,r.style.left=`${C}px`,r.style.width=L-C+"px",r.style.height=`${k}px`,a.style.left=`${C}px`,a.style.top=`${E}px`,a.style.width=L-C+"px",a.style.height=S-E+"px",o.style.left=`${L}px`,o.style.height=`${S}px`,o.style.width=y-L+"px"}(t,{x:s,y:i,width:r,height:n},e.strategy,5),hr()}return e}}),fr=t=>t?function(t){return void 0===t&&(t={}),{name:"autoPlacement",options:t,async fn(e){var s,i,r,n,o;const{x:a,y:l,rects:c,middlewareData:h,placement:u,platform:d,elements:p}=e,{alignment:g=null,allowedPlacements:m=Di,autoAlignment:f=!0,...v}=t,T=function(t,e,s){return(t?[...s.filter((e=>di(e)===t)),...s.filter((e=>di(e)!==t))]:s.filter((t=>ui(t)===t))).filter((s=>!t||di(s)===t||!!e&&Ei(s)!==s))}(g,f,m),w=await Ti(e,v),b=null!=(s=null==(i=h.autoPlacement)?void 0:i.index)?s:0,S=T[b];if(null==S)return{};const{main:y,cross:C}=ki(S,c,await(null==d.isRTL?void 0:d.isRTL(p.floating)));if(u!==S)return{x:a,y:l,reset:{placement:T[0]}};const k=[w[ui(S)],w[y],w[C]],L=[...null!=(r=null==(n=h.autoPlacement)?void 0:n.overflows)?r:[],{placement:S,overflows:k}],E=T[b+1];if(E)return{data:{index:b+1,overflows:L},reset:{placement:E}};const I=L.slice().sort(((t,e)=>t.overflows[0]-e.overflows[0])),D=null==(o=I.find((t=>{let{overflows:e}=t;return e.every((t=>t<=0))})))?void 0:o.placement,x=null!=D?D:I[0].placement;return x!==u?{data:{index:b+1,overflows:L},reset:{placement:x}}:{}}}}():function(t){return void 0===t&&(t={}),{name:"flip",options:t,async fn(e){var s;const{placement:i,middlewareData:r,rects:n,initialPlacement:o,platform:a,elements:l}=e,{mainAxis:c=!0,crossAxis:h=!0,fallbackPlacements:u,fallbackStrategy:d="bestFit",flipAlignment:p=!0,...g}=t,m=ui(i),f=u||(m!==o&&p?function(t){const e=Ci(t);return[Ei(t),e,Ei(e)]}(o):[Ci(o)]),v=[o,...f],T=await Ti(e,g),w=[];let b=(null==(s=r.flip)?void 0:s.overflows)||[];if(c&&w.push(T[m]),h){const{main:t,cross:e}=ki(i,n,await(null==a.isRTL?void 0:a.isRTL(l.floating)));w.push(T[t],T[e])}if(b=[...b,{placement:i,overflows:w}],!w.every((t=>t<=0))){var S,y;const t=(null!=(S=null==(y=r.flip)?void 0:y.index)?S:0)+1,e=v[t];if(e)return{data:{index:t,overflows:b},reset:{placement:e}};let s="bottom";switch(d){case"bestFit":{var C;const t=null==(C=b.map((t=>[t,t.overflows.filter((t=>t>0)).reduce(((t,e)=>t+e),0)])).sort(((t,e)=>t[1]-e[1]))[0])?void 0:C[0].placement;t&&(s=t);break}case"initialPlacement":s=o}if(i!==s)return{reset:{placement:s}}}return{}}}}();function vr(t){return window.innerWidth<1e3?"auto":t}const Tr=t=>{let{targetElement:e,bubble:s,orientation:i,extraModifier:r}=t;i=vr(i);const n=s.querySelector(".pointer");let o=[xi(25),fr("auto"===i),Pi({padding:5,crossAxis:!0})];r&&r.length&&(o=[...o,...r]),n&&o.push((t=>({name:"arrow",options:t,async fn(e){const{element:s,padding:i=0}=null!=t?t:{},{x:r,y:n,placement:o,rects:a,platform:l}=e;if(null==s)return{};const c=fi(i),h={x:r,y:n},u=pi(o),d=di(o),p=gi(u),g=await l.getDimensions(s),m="y"===u?"top":"left",f="y"===u?"bottom":"right",v=a.reference[p]+a.reference[u]-h[u]-a.floating[p],T=h[u]-a.reference[u],w=await(null==l.getOffsetParent?void 0:l.getOffsetParent(s));let b=w?"y"===u?w.clientHeight||0:w.clientWidth||0:0;0===b&&(b=a.floating[p]);const S=v/2-T/2,y=c[m],C=b-g[p]-c[f],k=b/2-g[p]/2+S,L=Si(y,k,C),E=("start"===d?c[m]:c[f])>0&&k!==L&&a.reference[p]<=a.floating[p];return{[u]:h[u]-(E?k<y?y-k:C-k:0),data:{[u]:L,centerOffset:k-L}}}}))({element:n})),lr(e,s,{placement:"auto"!==i?i:void 0,middleware:o}).then((t=>{let{x:e,y:i,placement:r,middlewareData:o}=t;Object.assign(s.style,{left:`${e}px`,top:`${i}px`}),s.setAttribute("data-floating-placement",r);const a=o.arrow;n&&Object.assign(n.style,{left:null!=(null==a?void 0:a.x)?`${null==a?void 0:a.x}px`:"",top:null!=(null==a?void 0:a.y)?`${null==a?void 0:a.y}px`:"",right:"",bottom:""})}))};const wr=class{constructor(t,e){this.getReverseEventName=t=>{let e;switch(t){case"mouseover":e="mouseleave";break;case"focus":e="blur";break;default:e=null}return e},this.linkClickAction=t=>{t.target instanceof HTMLAnchorElement&&t.target.href&&window.open(t.target.href,t.target.target)},this.registerClickEventsInBubble=t=>{t.querySelectorAll("a").forEach((t=>{t.addEventListener("mousedown",this.linkClickAction)}))},this.unRegisterClickEventsInBubble=t=>{t.querySelectorAll("a").forEach((t=>{t.removeEventListener("mousedown",this.linkClickAction)}))},this.getTarget=(t,e)=>{const{target:s}=t;try{const t=s.closest(e);if(t)return t}catch(t){return s}return s},this.preActions=(t,e)=>{if("focus"===t){const t=Te(e);t instanceof Element&&!t.hasAttribute("tabindex")&&t.setAttribute("tabindex","0")}},this.processEvents=(t,e,s)=>{var i,r;const n=Se(e);n.isAShadowDomSelector&&n.childSelector&&(e=n.childSelector);let o,a=this.getReverseEventName(t)||"";this.preActions(t,e);const l=i=>{const r=this.getTarget(i,e);if(e&&r&&r instanceof HTMLElement&&r.matches(e)){switch(t){case"mouseover":r.removeEventListener(a,this.hideCallbackFunction),this.showPositionedElement(r,s,(()=>{this.hideCallbackFunction(s)})),r.addEventListener(a,(()=>{this.hideCallbackFunction(s)}));break;case"focus":o=Pt(r,s,null==n?void 0:n.shadowDomSelector),this.showPositionedElement(r,s,(()=>{$t(o),this.unRegisterClickEventsInBubble(s),this.hideCallbackFunction(s)})),this.registerClickEventsInBubble(s),r.addEventListener(a,(()=>{$t(o),this.unRegisterClickEventsInBubble(s),this.hideCallbackFunction(s)}));break;case"click":o=Pt(r,s,null==n?void 0:n.shadowDomSelector),this.showPositionedElement(r,s,(()=>{$t(o),this.unRegisterClickEventsInBubble(s),this.hideCallbackFunction(s)})),this.registerClickEventsInBubble(s);break;default:a=""}o&&window.addEventListener(xt,(t=>{let{detail:e}=t;$t(o),this.unRegisterClickEventsInBubble(s),this.hideCallbackFunction(e)}))}};window.usetiful_smartTipsAddedEvents||(window.usetiful_smartTipsAddedEvents=[]),window.usetiful_smartTipsAddedEvents.push({eventName:t,eventFunction:l}),n.isAShadowDomSelector&&n.shadowDomSelector?null===(r=null===(i=document.querySelector(n.shadowDomSelector))||void 0===i?void 0:i.shadowRoot)||void 0===r||r.addEventListener(t,l,!0):document.addEventListener(t,l,!0)},this.showPositionedElement=(t,e,s)=>{this.showCallbackFunction(t,e,!1,s),window.addEventListener("resize",(()=>{this.showCallbackFunction(t,e,!0)}))},this.init=(t,e,s)=>{this.processEvents(t,e,s)},this.showCallbackFunction=t,this.hideCallbackFunction=e}},br=(t,e,s,i,r)=>{const n=ci(Gs);V(`report action index ${e} with action ${s}`),n.add({id:i,tourId:t||0,stepIndex:e,action:s,isDevKit:r})};var Sr,yr=function(t,e,s,i){if("a"===s&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?i:"a"===s?i.call(t):i?i.value:e.get(t)};Sr=new WeakMap;const Cr=class{constructor(t){this.init=()=>{window.usetiful_smartTipsAddedEvents&&window.usetiful_smartTipsAddedEvents.length&&window.usetiful_smartTipsAddedEvents.forEach((t=>{document.removeEventListener(t.eventName,t.eventFunction,!0)}));const t=ci(Qs);if(V("Start loading smart tips."),void 0!==this.smartTipsGroups){V("Checking available smart tips...");for(const e of this.smartTipsGroups){const{name:s,targets:i,tips:r,theme:n,targetOperator:o}=e;this.template.removeAllBeacons();let a=0;const l=setInterval((()=>{a+=1,ci(ii).checkByTargets(X(i),o)&&this.showToUser(e)&&(t.loadTheme(n,(()=>{this.template.setTheme(n);for(const t of r)this.initSmartTip(t)})),clearInterval(l),this.localStorageHandler.setProgressToLocalStorage("seen",e)),a>=60&&(clearInterval(l),V(`smart tip ${s} stop loading (limit reached)`))}),500);window.usetiful_intervals.push(l)}}else V("There is no smart tips here")},this.showToUser=t=>{const{id:e,trigger:s}=t;return!s||s&&("everytime"===s.type||"once"===s.type&&!this.localStorageHandler.getObjectState(e,"state"))},this.initSmartTip=t=>{const{id:e,name:s,title:i,content:r,element:n,displayOn:o,orientation:a,hotspot:l}=t,{customStyle:c}=t;V(`smart tip ${s} loaded`);const h=this.template.createBubble({ident:s,contentHTML:r,title:this.template.createTitle(4,i)||null,hotspot:l,customStyle:c||null});if(h instanceof HTMLElement){l&&this.hotspotController(h,n,a,o,Object.assign({id:e,name:s},l),c);new wr(((t,i,r,n)=>this.showSmartTipEventListener(t,i,a,r,s,e,n,void 0,o)),pr).init(o,n,h)}},this.showSmartTipEventListener=(t,e,s,i,r,n,o,a,l)=>{if(!i){if(dr(e),Tr({targetElement:t,bubble:e,orientation:s}),this.waitingTips.indexOf(r.toString())<0&&this.waitingTips.push(r.toString()),window.setTimeout((()=>{this.waitingTips.indexOf(r.toString())>-1?(V(`View of smart tip ${r.toString()} reported.`),br(r,0,it,n,!1)):K(`Smart tip ${r.toString()} was displayed for less than 1 sec. Sending to reporter skipped.`),this.waitingTips=this.waitingTips.filter((t=>t!==r.toString()))}),1e3),a){const t=document.getElementById(a);null==t||t.classList.add("max-zindex")}if(o){const{body:s}=document;s&&setTimeout((()=>{this.oldTarget&&(this.oldTarget.removeEventListener("click",yr(this,Sr,"f")),this.oldTarget=void 0),this.oldBeacon&&(this.oldBeacon.removeEventListener("click",yr(this,Sr,"f")),this.oldBeacon=void 0),s.addEventListener("click",(()=>{o()}),{once:!0}),"click"===l&&(e.addEventListener("click",yr(this,Sr,"f")),t.addEventListener("click",yr(this,Sr,"f")),this.oldTarget=t,a&&(this.oldBeacon=document.getElementById(a),this.oldBeacon&&this.oldBeacon.addEventListener("click",yr(this,Sr,"f"))))}),0)}}},this.hotspotController=(t,e,s,i,r,n)=>{let o=we(e);const a=()=>null==o?void 0:o.forEach(((e,o)=>{t.classList.remove(this.template.themeClasses.bubbleInvisible),dr(t);const a=e,l=`beacon${r.id}${r.name}${r.index}`,c=this.template.createBeacon(l,function(t){var e;let s=t,i="auto";for(;s;){const{position:t}=getComputedStyle(s);if("static"!==t){const t=parseInt(null===(e=getComputedStyle(s))||void 0===e?void 0:e.zIndex,10);Number.isNaN(t)||(i=t.toString())}s=s.parentElement}return i}(a),r.type,n);((t,e,s,i,r)=>{pr(s),e.orientation||(e.orientation="auto"!==i?i:"right"),"top"!==e.orientation&&0!==e.offsetVertical&&(e.offsetVertical=e.offsetVertical<0?Math.abs(e.offsetVertical):-Math.abs(e.offsetVertical)),"left"===e.orientation&&0!==e.offsetHorizontal&&(e.offsetHorizontal=e.offsetHorizontal<0?Math.abs(e.offsetHorizontal):-Math.abs(e.offsetHorizontal));const n="top"===e.orientation||"bottom"===e.orientation,o={mainAxis:-15+(n?e.offsetVertical:e.offsetHorizontal),crossAxis:0+(n?e.offsetHorizontal:e.offsetVertical)},a=s=>lr(t,r,{placement:e.orientation,middleware:[xi(o)]}).then((t=>{let{x:e,y:i}=t;Object.assign(r.style,{left:`${e}px`,top:`${i}px`}),s&&s()}));ar(t,r,(()=>a()),{animationFrame:!0}),ar(t,r,(()=>a()),{ancestorScroll:!0})})(a,Object.assign(Object.assign({},r),{index:o}),t,s,c);new wr(((t,n,o,a)=>this.showSmartTipEventListener(e,n,s,o,r.name,r.id,a,l,i)),(t=>pr(t,l))).init(i,`#${l}`,t)}));o&&o.length?a():(window.usetiful_smartTipsObserver||(window.usetiful_smartTipsObserver=[]),window.usetiful_smartTipsObserver[r.id]=setInterval((()=>{o=we(e),o&&o.length&&(a(),clearInterval(window.usetiful_smartTipsObserver[r.id]))}),1e3))},Sr.set(this,(t=>{t.stopPropagation()})),this.registerListeners=()=>{document.addEventListener(k.tipHidden,(t=>{this.waitingTips=this.waitingTips.filter((e=>e!==t.detail.bubbleId))}))},this.smartTipsGroups=t,this.isWatermark=ci(ai.watermark),this.template=new Be(null,this.isWatermark),this.localStorageHandler=ci(oi),this.oldTarget=null,this.oldBeacon=null,this.waitingTips=[],this.registerListeners()}},kr="click",Lr="pageEvent",Er="startTour",Ir="immediately",Dr="openURL",xr="nothing";const Ar=class{constructor(){this.saveToStorage=t=>{this.progressorApi.saveUserData(J,JSON.stringify(t))},this.progressorApi=ci(Zs),this.checklistData=[],this.alreadyParsed=!1,this.processParseData()}processParseData(){if(this.alreadyParsed)return;const t=this.progressorApi.getUserData(J);if(t&&"string"==typeof t){const e=JSON.parse(t);this.saveToLocalStorage(e),this.checklistData=e}else this.loadFromLocalStorage(),this.saveToStorage(this.checklistData);this.alreadyParsed=!0}loadFromLocalStorage(){const t=localStorage.getItem(J);t&&(this.checklistData=JSON.parse(t))}isRedirected(t){if(this.loadFromLocalStorage(),this.checklistData&&this.checklistData.length>0){return void 0!==this.checklistData.find((e=>e.id===t))}return!1}markAsRedirected(t){this.alreadyParsed=!1,this.processParseData();void 0!==this.checklistData.find((e=>e.id===t))||this.checklistData.push({id:t}),this.saveToStorage(this.checklistData),this.saveToLocalStorage(this.checklistData)}saveToLocalStorage(t){localStorage.setItem(J,JSON.stringify(t))}};var Pr='<svg class="svg-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="9" stroke="#000" stroke-width="1.5" stroke-linecap="round"/></svg>';const $r="done",Or="open",Br="inProgress",Nr="pageEvent";const Rr=class{constructor(t,e,s,i){this.checklistItemAction=t=>{const{id:e,onClickAction:s,tourId:i,url:r,urlOpenTargetBlank:n,completionOn:o}=this.checklistItem;if(s===Er&&i>0&&(r&&""!==r?this.tourTriggers.setTourTriggerToLocalStorage(i):this.runTourOnClickAction(t,i)),s!==xr&&r&&""!==r){o===kr&&(this.redirects.markAsRedirected(e),this.processStateClasses());We(r,n||!1)}s===xr&&o===kr&&(this.redirects.markAsRedirected(e),this.processStateClasses())},this.getItemState=()=>{const t=ci(ni),{id:e,onClickAction:s,tourId:i,completionOn:r,pageEvent:n}=this.checklistItem;if(r===kr){if(s===Er){const e=t.getObjectStatus(i.toString());if("closed"===e)return $r;if("inProgress"===e)return Br}else if((s===Dr||s===xr)&&this.redirects.isRedirected(e))return $r}else{if(r===Lr&&n)return this.redirects.isRedirected(e)?$r:Nr;if(r===Ir)return $r}return Or},this.processStateClasses=()=>{const t=this.getItemState();t!==Nr&&this.changeItemStyle(t)},this.changeItemStyle=t=>{switch(t){case $r:this.itemElement.classList.add(this.template.themeClasses.done),this.itemElement.dataset.ufStatus="done",this.template.changeItemToDoneStyle(this.checklistItem.id),this.template.checklistProgressUpdate();break;case Br:this.itemElement.classList.add(this.template.themeClasses.inProgress),this.itemElement.dataset.ufStatus="in-progress";break;case Or:this.itemElement.classList.remove(this.template.themeClasses.done),this.itemElement.dataset.ufStatus="init",this.itemElement.classList.remove(this.template.themeClasses.inProgress)}},this.checklistItemIcon=()=>{switch(this.getItemState()){case Or:return Pr;case $r:return'<svg class="svg-icon filled" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M12 3.75a8.25 8.25 0 100 16.5 8.25 8.25 0 000-16.5zM2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12z"/><path clip-rule="evenodd" d="M16.465 8.411a.75.75 0 01.124 1.054l-4.404 5.577a1.25 1.25 0 01-1.827.145l-2.866-2.635a.75.75 0 111.016-1.104l2.667 2.453 4.236-5.366a.75.75 0 011.054-.124z"/></svg>';case Br:return'<svg class="svg-icon filled" width="20" height="20" viewBox="0 0 40 32" xmlns="http://www.w3.org/2000/svg"><path d="M3.968 12.061A3.965 3.965 0 000 16.027a3.965 3.965 0 003.968 3.967 3.966 3.966 0 100-7.933zm12.265 0a3.967 3.967 0 00-3.968 3.965c0 2.192 1.778 3.967 3.968 3.967s3.97-1.772 3.97-3.967a3.97 3.97 0 00-3.97-3.965zm11.857 0a3.967 3.967 0 10-.005 7.933 3.967 3.967 0 00.005-7.933z"/></svg>';default:return Pr}},this.render=()=>(this.itemElement.innerHTML=`${this.checklistItemIcon()}<span>${this.checklistItem.title}</span>`,this.itemElement),this.checklistItem=t,this.template=e,this.redirects=new Ar,this.runTourOnClickAction=s,this.tourTriggers=i,this.itemElement=this.template.createButton("",this.template.themeClasses.button),this.itemElement.classList.add(this.template.themeClasses.buttonBlock),this.itemElement.dataset.id=this.checklistItem.id,this.itemElement.addEventListener("click",(t=>{this.checklistItemAction(t)}),!1),this.processStateClasses()}};window.USETIFUL||(window.USETIFUL={});class Ur{constructor(t,e){this.disabledTourSelection=()=>{window.localStorage.setItem(v,"disabled")},this.enableTourSelection=()=>{window.localStorage.setItem(v,"enabled")},this.isTourSelectionEnabled=()=>"disabled"!==window.localStorage.getItem(v),this.destroy=()=>{this.hideTourSelection()},this.init=t=>{this.shouldBeDisplayed=t,this.hideTourSelection(),this.loadChecklist(),((t,e,s,i)=>{const r={start:i=>{const r=t.find((t=>t.id===i));if(!r)throw new Error("Your checklist Id is not valid!");window.USETIFUL.checklist.close(),setTimeout((()=>{e(r),s(r)}),500)},close:()=>{},done:(r,n)=>{const o=localStorage.getItem(p);if(n)n!==o&&window.USETIFUL.checklist.close();else if(!(n=o))throw new Error("Please send checklistId as a second parameter or run a checklist by start API");const a=t.find((t=>t.id===n));if(!a)throw new Error("Your checklist Id is not valid!");r.forEach((t=>{if(!a.items.length||!a.items[t-1])throw new Error("Your row number is not valid!");const e=a.items[t-1];if("startTour"===e.onClickAction&&e.completionOn===kr){let t=[];const s=localStorage.getItem(q);s&&(t=JSON.parse(s)),t.push({id:e.tourId,name:"",currentStep:0,state:"closed"}),localStorage.setItem(q,JSON.stringify(t))}else{let t=[];const s=localStorage.getItem(J);s&&(t=JSON.parse(s)),t.push({id:e.id}),localStorage.setItem(J,JSON.stringify(t))}})),i(),e(a),s(a)}};window.USETIFUL.checklist=r})(this.checklists,this.runChecklist,this.showChecklist,this.hideTourSelection)},this.dismissChecklist=t=>{localStorage.removeItem(p),this.dismiss.setDismissValue(!0,t);const e=new Event(k.checklistDismissed);document.dispatchEvent(e)},this.checkAvailables=()=>(V("Start loading checklist"),V("Checking available checklists..."),new Promise(((t,e)=>{if(0===this.checklists.length)V("There is no checklists here"),e();else for(const e of this.checklists){const{id:s,targets:i,targetOperator:r}=e;this.dismiss.isChecklistDismiss(s)||this.availableOnPage.checkTargetWithWaiting(X(i),r).then((()=>{t(e)}),(()=>{}))}}))),this.showTourSelection=(t,e)=>{this.enableTourSelection(),this.isLoaded=!0;const{id:s,name:i,items:n,labels:o,progressBar:a,dismiss:l,alignment:c,showCompleteMessage:h,congratulation:u}=t,{dismiss:{text:d,description:p,confirm:g,cancel:m}}=o,f=document.querySelector(`.${this.template.themeClasses.tourSelection}`),v=this.getCompletedItems(n);if(f)return void f.classList.add(r.visible);const T=v.length===n.length,w=h&&T&&u,b=document.createElement("h3");b.dataset.ufElement="title",b.classList.add(this.template.themeClasses.title),a||b.classList.add(this.template.themeClasses.titleWithoutProgress),b.innerHTML=w?u.title:i;const S=[this.template.themeClasses.tourSelection];w&&S.push(this.template.themeClasses.congratulation),this.template.notifyUser("checklist",b,a&&!w?`<span class="${this.template.themeClasses.progressValue}">${Math.round(v.length/(n.length/100))}%</span><div class="${this.template.themeClasses.progress}"><div class="${this.template.themeClasses.progressbar}" style="width: ${Math.round(v.length/(n.length/100))}%;"></div></div>`:null,(()=>{const t=this.template.createWrapper(this.template.themeClasses.actions);if(w){t.classList.add(this.template.themeClasses.actionsPaddingAround);const e=document.createElement("div");e.innerHTML=ge(u.content),t.append(e)}else for(const s of n){const i=new Rr(s,this.template,((t,s)=>e(t,s,!0,(()=>{this.hideTourSelection()}))),this.tourTriggers);t.append(i.render())}if(l){const e=this.template.createWrapper(this.template.themeClasses.bottomAction);e.classList.add(this.template.themeClasses.bottomAction);const i=this.template.createLink(d,"");i.addEventListener("click",(t=>{this.template.confirmation("",p,g,m,(()=>{Le(`.${this.template.themeClasses.notification}`),Le(`.${this.template.themeClasses.buttonMain}`),this.dismissChecklist(s)}),c),t.stopImmediatePropagation(),t.preventDefault()}),!1),e.append(i),t.append(e)}return t}),S,this.disabledTourSelection,c)},this.hideTourSelection=()=>{Le(`.${this.template.themeClasses.tourSelection}`),this.selectedChecklist=null},this.isAvailableChecklist=()=>this.checklists&&this.checklists.length>0&&!this.dismiss.isAllChecklistsDismissed(this.checklists),this.showChecklist=t=>{localStorage.setItem(p,t.id),this.selectedChecklist=t,this.showTourSelection(t,((t,e)=>this.runTourOnClickAction(t,e,!0,(()=>this.hideTourSelection()))))},this.placeTriggers=()=>{this.isAvailableChecklist()&&(this.selectedChecklist?this.placeChecklistItemsTriggers(this.selectedChecklist):this.checkAvailables().then((t=>{this.placeChecklistItemsTriggers(t)})))},this.loadChecklist=()=>{this.isAvailableChecklist()?this.selectedChecklist?this.showTourSelection(this.selectedChecklist,this.runTourOnClickAction):this.checkAvailables().then((t=>{this.runChecklist(t)})):this.isLoaded=!1},this.getCompletedItems=t=>{const e=ci(ni);return t.filter((t=>{if(t.completionOn===Ir)return!0;if(t.onClickAction===Dr||t.completionOn===Lr){return(new Ar).isRedirected(t.id)}return"closed"===e.getObjectStatus(t.tourId.toString())}))},this.runChecklist=t=>{if(this.isDestroyed)return;this.isLoaded=!0;const{id:e,labels:s,showButton:i,items:r,theme:n,alignment:o}=t;this.shouldBeDisplayed(y)&&this.loader.loadTheme(n,(()=>{if(this.template.setTheme(n),this.mainButton.setTheme(n),i){const{button:i}=s;this.mainButton.setAvailableTours(r);const n=r.length-this.getCompletedItems(r).length;this.mainButton.prepareMainButton(`checklist_${e}`,this.mainButton.getButtonLabelContent(i,n),(()=>{this.showChecklist(t)}),o),this.isTourSelectionEnabled()&&this.showChecklist(t)}else this.showChecklist(t)}))},this.placeChecklistItemsTriggers=t=>{t.items.forEach((t=>{if(t.completionOn===Lr){const{pageEvent:e,id:s}=t,i=new Re(e,this.availableOnPage);i.isChecklistItem=!0,i.triggerFunction=this.markAsDoneEvent,i.checklistItemId=s;ci(Ys).placeTrigger(i),this.placedTriggers.push(i)}}))},this.removeTriggers=()=>{if(this.placedTriggers.length>0){const t=ci(Ys);this.placedTriggers.forEach((e=>{t.removeFromActiveTriggers(e)})),this.placedTriggers=[]}},this.markAsDoneEvent=t=>{(new Ar).markAsRedirected(t),this.template.changeItemToDoneStyle(t),this.template.checklistProgressUpdate()},this.destroyInstance=()=>{this.removeTriggers(),Le("[data-uf-button='button-main']"),Le("[data-uf-content='checklist']"),this.isDestroyed=!0,this.checklists=[]},this.checklists=t,this.runTourOnClickAction=e,this.tourTriggers=ci(Xs),this.loader=ci(Qs),this.selectedChecklist=null,this.mainButton=ci(si),this.isWatermark=ci(ai.watermark),this.dismiss=ci(ei),this.isLoaded=!1,this.template=new Be(null,this.isWatermark),this.shouldBeDisplayed=()=>!0,this.availableOnPage=ci(ii),this.isDestroyed=!1,this.placedTriggers=[]}}var Mr='<svg xmlns="http://www.w3.org/2000/svg"><path stroke="#000" stroke-width="2" d="M1 16L16 1M1 1l15 15"/></svg>',Wr='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 21 21"><path data-name="Rectangle 1" d="M25 21H4V0h21z" fill="none"/><path data-name="Path 1" d="M13.594 11.594l-5.16 5.16a.84.84 0 11-1.189-1.188L11.812 11 7.247 6.434a.84.84 0 011.188-1.188l5.16 5.16a.84.84 0 010 1.188z" fill="#1d1d1d"/></svg>';const Hr=class{constructor(){var t=this;let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.getThemeClasses=()=>this.template.themeClasses,this.getTitle=t=>{const e=document.createElement("h3");return e.classList.add(this.getThemeClasses().title),e.dataset.ufElement="title",e.innerHTML=t,e},this.createLink=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"_self";const r=document.createElement("a");return r.classList.add(t.getThemeClasses().button,t.getThemeClasses().buttonBlock),r.href=s,r.target=i,r.innerHTML=`<span>${e}</span><div class="${[t.template.themeClasses.buttonIcon,t.template.themeClasses.buttonIconRight].join(" ")}">${Wr}</div>`,r},this.createButton=(t,e)=>{const s=document.createElement("button");return s.classList.add(this.getThemeClasses().button,this.getThemeClasses().buttonBlock),s.onclick=e,s.innerHTML=`<span>${t}</span><div class="${[this.getThemeClasses().buttonIcon,this.getThemeClasses().buttonIconRight].join(" ")}">${Wr}</div>`,s},this.createSearchResult=(t,e,s)=>{const i=document.createElement("span"),r=document.createElement("a");return r.href="javascript:void(0);",r.onclick=s,r.innerText=t,i.innerHTML=`<p>${e}</p>`,i.prepend(r),i},this.showArticle=(t,e,s,i,r)=>{const n=document.createElement("div");n.dataset.ufContent="slideout",n.classList.add(this.getThemeClasses().slideout),"bottom-left"===s?(n.style.left="0px",n.classList.add(this.getThemeClasses().left)):(n.style.right="0px",n.classList.add(this.getThemeClasses().right)),n.style.bottom="0px";const o=document.createElement("div");o.classList.add(this.getThemeClasses().articleInner);const a=this.getTitle(t),l=document.createElement("div");l.classList.add(this.getThemeClasses().content),l.innerHTML=e;const c=this.createBackButton((t=>{"function"==typeof i&&(i(t),ke(n))})),h=this.createCloseButton((t=>{"function"==typeof i&&(r(t),ke(n))}));o.appendChild(c),o.appendChild(h),o.appendChild(a),o.appendChild(l),n.appendChild(o),this.template.showElement(n)},this.createCloseButton=t=>{const e=document.createElement("button");return e.type="button",e.classList.add(this.getThemeClasses().buttonClose),e.addEventListener("click",t),e.innerHTML=Mr,this.template.appendButtonDataAttributes(e),e},this.createBackButton=t=>{const e=document.createElement("button");return e.type="button",e.classList.add(this.getThemeClasses().buttonBack),e.addEventListener("click",t),e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="21" height="21" viewBox="0 0 21 21" fill="currentcolor"><path d="M13.648 6.89c0 .09-.035.169-.101.235l-4.031 4.031 4.03 4.031a.323.323 0 010 .47l-.515.515a.323.323 0 01-.469 0l-4.78-4.781a.323.323 0 010-.47l4.78-4.78a.323.323 0 01.47 0l.515.515a.323.323 0 01.101.235zm0 0"/></svg>',e},this.getSearchBox=()=>document.querySelector(`.${this.getThemeClasses().searchBox}`),this.createSearchBox=(t,e,s)=>{const i=document.createElement("div");i.classList.add(this.getThemeClasses().searchBox);const r=document.createElement("input");r.type="text",r.placeholder=t,r.addEventListener("keyup",(t=>{var s;const i=t.target.value,r=null===(s=this.getSearchBox())||void 0===s?void 0:s.querySelector('button[role="reset"]');i.length?null==r||r.removeAttribute("style"):null==r||r.setAttribute("style","display:none"),e(i)}));const n=document.createElement("button");return n.setAttribute("role","reset"),n.setAttribute("style","display:none"),n.innerHTML=Mr,n.onclick=()=>{var t,e;r.value="",s(),null===(e=null===(t=this.getSearchBox())||void 0===t?void 0:t.querySelector('button[role="reset"]'))||void 0===e||e.setAttribute("style","display:none")},i.appendChild(r),i.appendChild(n),i},this.showBox=t=>{const{title:e,content:s,createActions:i,closeAction:r,alignment:n="bottom-right",search:o,classes:a}=t;let l;const c=document.createElement("div");c.dataset.ufContent="assistant",c.setAttribute("style","display: none"),a&&c.classList.add(...a.split(" "));const h=document.createElement("div");h.classList.add(this.getThemeClasses().notificationInner),l=e instanceof HTMLElement?e:this.getTitle(e);const u=this.createCloseButton((()=>{"function"==typeof r&&r(c)}));h.appendChild(u),h.appendChild(l);const d=document.createElement("div");d.classList.add(this.getThemeClasses().content),s instanceof HTMLElement?d.appendChild(s):d.innerHTML=s;const p=o(c);if(p instanceof HTMLElement&&(d.innerHTML="",d.appendChild(p),h.classList.add(this.getThemeClasses().notificationSearchInner)),h.appendChild(d),i){const t=i(c);h.append(t)}c.appendChild(h),c.classList.add(this.getThemeClasses().notification,this.getThemeClasses().tourSelection),"bottom-left"===n?(c.style.left="0px",c.classList.add(this.getThemeClasses().left)):(c.style.right="0px",c.classList.add(this.getThemeClasses().right)),c.style.bottom="0px",this.template.isWatermark&&h.append(this.template.createWatermarkBadge()),this.template.showElement(c)},this.template=new Be(e,s)}setTheme(t){this.template.setTheme(t)}},jr="Search in the knowledge base",Fr="reset";const _r=class{constructor(t,e,s){this.initSearchBox=t=>{if(this.assistantElement=t,this.options.search){const t=this.makeDelay();return this.template.createSearchBox(this.options.searchPlaceholder,(e=>{e.length||this.triggerCallbackFunction(Fr,null),t(e)}),(()=>{this.triggerCallbackFunction(Fr,null)}))}return null},this.isCallbackDefined=()=>"function"==typeof this.callback,this.triggerCallbackFunction=(t,e)=>{if(null===this.callback)throw new Error("call must be initialized first");if(null===this.assistantElement)throw new Error("assistantElement must be initialized first");this.isCallbackDefined()&&this.callback(this.assistantElement,t,e)},this.makeDelay=()=>{let t;return e=>{clearTimeout(t),t=setTimeout((()=>{if(this.isCallbackDefined()&&e.length>=3){this.api.get(`/search?query=${e}`).onload=t=>{let{currentTarget:{status:e,response:s}}=t;if(e>=200&&e<400){const t=JSON.parse(s);this.triggerCallbackFunction("result",t)}}}}),this.options.delay)}},this.api=ci(Vs),this.template=t,this.assistantElement=null,this.callback=s;const i={search:!1,delay:500,searchPlaceholder:jr};this.options=Object.assign(Object.assign({},i),e)}};var qr=function(t,e){var s={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(s[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(s[i[r]]=t[i[r]])}return s};const zr="assistantSelection";const Jr=class{constructor(t,e){var s=this;this.getElementSelector=()=>`.${this.template.getThemeClasses().tourSelection}[data-type="assistant"]`,this.disabledAssistantSelection=()=>{window.localStorage.setItem(zr,"disabled")},this.enableAssistantSelection=()=>{window.localStorage.setItem(zr,"enabled")},this.isAssistantSelectionEnabled=()=>"disabled"!==window.localStorage.getItem(zr),this.getAvailable=()=>(V("Checking available assistant..."),new Promise(((t,e)=>{if(0===this.assistants.length)return V("There is no checklists here"),void e();this.assistants.forEach((e=>{ci(ii).checkTargetWithWaiting(X(e.targets),e.targetOperator).then((()=>{t(e)}),(()=>{}))}))}))),this.isAvailableAssistants=()=>this.assistants&&this.assistants.length>0,this.loadAssistant=()=>{this.isAvailableAssistants()&&this.getAvailable().then((t=>{this.runAssistant(t)}))},this.fetchSearchItems=(t,e,s,i)=>{const n=document.createElement("div");return n.classList.add(this.template.getThemeClasses().searchResults),e.articles.length>0?e.articles.forEach((e=>{let{name:i,description:o,content:a}=e;n.appendChild(this.template.createSearchResult(i,o,(()=>{t.classList.remove(r.visible),this.template.showArticle(i,a,s,(()=>{t.classList.add(r.visible)}),(()=>this.closeAssistant(t)))})))})):n.innerText=i,n},this.createActions=(t,e,s)=>{const i=document.createElement("div");return i.classList.add(this.template.getThemeClasses().actions),e.forEach((e=>{var{type:n}=e,o=qr(e,["type"]);let a;if("link"===n){const{title:t,url:e,urlOpenTargetBlank:s}=o;a=this.template.createLink(t,e,s?"_blank":"_self")}else if("article"===n){const{title:e,article:{name:i,content:n}}=o;a=this.template.createButton(e,(()=>{i&&n&&(t.classList.remove(r.visible),this.template.showArticle(i,n,s,(()=>{t.classList.add(r.visible)}),(()=>this.closeAssistant(t))))}))}else if("tour"===n){const{title:t,tourId:e}=o;a=this.template.createButton(t,(t=>{e&&e>0&&this.runTourOnClickAction(t,e,!0,(()=>{this.closeAssistant(),this.enableAssistantSelection()}))}))}a&&i.appendChild(a)})),i},this.closeAssistant=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;s.disabledAssistantSelection(),t?ke(t):Le(s.getElementSelector())},this.destroy=()=>{setTimeout((()=>{Le(this.getElementSelector())}),100)},this.showAssistant=t=>{const{id:e,name:s,description:i,items:r,alignment:n,search:o,searchAttributes:a}=t;this.enableAssistantSelection();const l=document.createElement("span");l.classList.add(this.template.getThemeClasses().description),l.innerHTML=i;const c={search:o};(null==a?void 0:a.placeholder)&&(c.searchPlaceholder=a.placeholder);const h=new _r(this.template,c,((t,e,s)=>{var i;const o=document.querySelector(`.${this.template.getThemeClasses().actions}`);if(o)if(o.innerHTML="","result"===e){const e=this.fetchSearchItems(t,s,n,a.emptyResults);o.appendChild(e)}else if("reset"===e){const e=this.createActions(t,r,n);null===(i=o.parentNode)||void 0===i||i.replaceChild(e,o)}}));this.template.showBox({id:e,type:"assistant",title:s,content:l,alignment:n,search:t=>h.initSearchBox(t),closeAction:this.closeAssistant,createActions:t=>this.createActions(t,r,n)})},this.runAssistant=t=>{if(this.isDestroyed)return;const{id:e,theme:s,description:i,showButton:r,buttonLabel:n,alignment:o}=t;this.shouldBeDisplayed(C)&&this.loader.loadTheme(s,(()=>{this.template.setTheme(s),this.mainButton.setTheme(s);const a=document.createElement("span");a.classList.add(this.template.getThemeClasses().description),a.innerHTML=i,r?(this.mainButton.prepareMainButton(`assistant_${e}`,this.mainButton.getButtonLabelContent(n),(()=>{this.showAssistant(t)}),o),this.isAssistantSelectionEnabled()&&this.showAssistant(t)):this.showAssistant(t)}))},this.init=t=>{this.shouldBeDisplayed=t,this.destroy(),this.loadAssistant()},this.destroyInstance=()=>{Le("[data-uf-button='button-main']"),Le("[data-uf-content='assistant']"),this.isDestroyed=!0,this.assistants=[]},this.assistants=t,this.runTourOnClickAction=e,this.loader=ci(Qs),this.mainButton=ci(si),this.template=new Hr(null,!1),this.shouldBeDisplayed=()=>!0,this.isDestroyed=!1}};const Vr=class{constructor(t,e,s){this.assistant=t,this.checklist=e,this.tours=s,this.isDisplayedContent=!1,this.isDestroyed=!1,this.displayedContentType=S}setDisplayContent(t){this.isDisplayedContent!==t&&(V(`ContentLoader: call display content change -> ${t}`),this.isDisplayedContent=t,this.init())}shouldBeDisplayed(t){return this.displayedContentType!==t&&((t!==C||this.displayedContentType!==y)&&(this.displayedContentType=t,!0))}init(){if(!this.isDestroyed){if(this.timeoutID&&window.clearTimeout(this.timeoutID),this.checklist.placeTriggers(),!this.isDisplayedContent)return this.displayedContentType=S,this.removeEventListeners(),this.checklist.destroy(),this.assistant.destroy(),this.placeTourEventListeners(),void(this.timeoutID=window.setTimeout((()=>{V("ContentLoader: waiting to init checklist or assistant..."),this.init()}),250));this.checklist.init((t=>this.shouldBeDisplayed(t))),this.placeEventListeners(),this.checklist.isLoaded||this.assistant.init((t=>this.shouldBeDisplayed(t)))}}placeEventListeners(){document.addEventListener(k.checklistDismissed,(()=>this.reinit()),!1)}placeTourEventListeners(){document.addEventListener(k.setDisplay,(t=>{this.isDestroyed||this.setDisplayContent(t.detail.value)}),!1),document.addEventListener(k.initContentLoader,(()=>this.init()),!1)}removeEventListeners(){document.removeEventListener(k.checklistDismissed,(()=>this.reinit()),!1),document.removeEventListener(k.initContentLoader,(()=>this.init()),!1)}reinit(){this.displayedContentType=S,this.init()}destroy(){this.removeEventListeners(),this.displayedContentType=S,this.isDestroyed=!0,this.checklist.destroyInstance(),this.assistant.destroyInstance(),this.timeoutID&&window.clearTimeout(this.timeoutID)}};const Kr=class{constructor(t,e,s,i){this.placeTrigger=()=>{this.shouldPlaceTrigger()?this.setProgressOnClickTrigger():this.type===n&&Lt({name:k.placeNextStepAppearTrigger,tourId:this.tourId})},this.removeTrigger=()=>{this.removeProgressOnClickTrigger()},this.shouldPlaceTrigger=()=>this.type&&this.type!==n&&"buttons"!==this.type,this.setProgressOnClickTrigger=()=>{if(V(`setProgressOnClickTrigger: Setting click trigger on ${this.pointerSelector}...`),this.commonTriggerController.hasProgressOnClickTrigger(this.pointerSelector))return;const t={type:this.eventName,element:this.pointerSelector,url:"",loop:"-1"},e=new Re(t,ci(ii));e.isProgressOnClick=!0,this.commonTriggerController.isTriggerMissing(e)&&(e.triggerFunction=this.elementTrigger,this.commonTriggerController.addToActiveTriggers(e),this.commonTriggerController.placeCentralListener(e.eventName,e.elementSelector))},this.removeProgressOnClickTrigger=()=>{if(V(`Removing progress trigger ${this.eventName} on ${this.pointerSelector} ...`),ve(this.pointerSelector)){if(Te(this.pointerSelector)){this.commonTriggerController.searchInActiveTriggers(this.eventName,this.pointerSelector).forEach((t=>{t.isProgressOnClick&&this.commonTriggerController.removeFromActiveTriggers(t)}))}}};switch(this.type=t||"",this.pointerSelector=e||"",this.elementTrigger=s||(()=>{K("ProgressOnClickControl doesn't contain functions for elementTrigger.")}),this.commonTriggerController=ci(Ys),this.eventName="",this.tourId=i,t){case"element":this.eventName="mouseup";break;case"screen":this.eventName="mouseup",this.pointerSelector="body"}}},Gr=t=>{V(t)};const Xr=class{constructor(t,e){this.runTriggerEvent=()=>{switch(this.stepData.eventType){case"jsEvent":this.runJsEvent();break;case"webhook":this.runWebhookCall()}},this.runJsEvent=()=>{if(this.stepData.eventName){let t;try{if(""!==this.stepData.eventContent){t=ge(this.stepData.eventContent);const[e]=JSON.parse(`[{ "bubbles": true, "detail": {${t}}}]`);this.options=e,this.event=new CustomEvent(this.stepData.eventName,this.options)}}catch(t){console.warn(`Trigger event step contains this error: ${t}`)}this.event&&this.element&&(O&&this.element.addEventListener(this.stepData.eventName,(()=>{console.log(this.event)})),this.element.dispatchEvent(this.event))}},this.runWebhookCall=()=>{if(this.stepData.webhookUrl&&""!==this.stepData.eventContent)try{const t=ge(this.stepData.eventContent),e=JSON.parse(`{${t}}`);e&&((t,e)=>{const s=t,i=new XMLHttpRequest;i.onreadystatechange=()=>{4===i.readyState&&Gr(i.response)},i.open("POST",s,!0),s.includes("zapier.com")||i.setRequestHeader("Content-Type","application/json"),i.send(JSON.stringify(e))})(this.stepData.webhookUrl,e)}catch(t){console.warn(`Trigger event step contains this error: ${t}`)}},this.runPageAction=()=>{if(this.stepData.actionType){if(!this.stepData.element)return void console.warn("Element for automated action is empty");switch(this.stepData.actionType){case"fill":{const t=we(this.stepData.element);null==t||t.forEach((t=>{t instanceof HTMLInputElement&&this.stepData.actionValue&&(t.value=ge(this.stepData.actionValue))}));break}case"click":{const t=Te(this.stepData.element);if(t&&t instanceof HTMLElement){t.click();const e=new MouseEvent("mouseup",{bubbles:!0,cancelable:!0,view:window});t.dispatchEvent(e)}break}}}},this.makeAutoRedirect=()=>{var t;const e=nt;if(!this.currentTour)return!1;if(this.stepData.automatic&&this.stepData.url){const s=!He(window.location.href,this.stepData.url);this.step.modifyURLBeforeRedirect(this.stepData);const i=this.currentTour.getTour(),r=null===(t=this.currentTour.getCurrentStep())||void 0===t?void 0:t.id;return i&&r?br(i.id,this.currentTour.getCurrentStepIndex(),e,r,!1):console.error(`Could not send data to reporter before auto refirect for tour: ${i.id} and step: ${r}`),"self"===this.stepData.tourName&&this.currentTour.goToNextStep(!1),(s||"self"!==this.stepData.tourName)&&this.currentTour.closeTour(ct),We(this.stepData.url,!1),!0}return!1},this.step=t,this.stepData=t.stepData,this.stepData.eventName&&(this.event=new CustomEvent(this.stepData.eventName)),this.element=window,this.stepData.element&&""!==this.stepData.element&&Te(this.stepData.element)&&(this.element=Te(this.stepData.element)),this.stepData.type===ie&&(this.currentTour=e)}};const Yr=['<svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><g stroke="#000" stroke-width="2"><circle cx="16" cy="16" r="14"/><path d="M8.5 12.5c.5-.833 2.5-2 4.5 0M19 12.5c.5-.833 2.5-2 4.5 0" stroke-linecap="round" stroke-linejoin="round"/><path d="M16 25c5.85 0 8.438-4.667 9-7 0 0-5.458 1.273-9 1.273S7 18 7 18c.563 2.333 3.15 7 9 7z" stroke-linejoin="round"/></g></svg>','<svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="16" cy="16" r="14" stroke="#000" stroke-width="2"/><rect x="8" y="19" width="16" height="2" rx="1" fill="#000"/><ellipse cx="11.5" cy="12.5" rx="1.5" ry="2.5" fill="#000"/><ellipse cx="20.5" cy="12.5" rx="1.5" ry="2.5" fill="#000"/></svg>','<svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><g stroke="#000" stroke-width="2"><circle cx="16" cy="16" r="14"/><path d="M19.91 13.495c.061-.97 2.649-2.496 3.997-2.067M12.59 13.495c-.061-.97-2.649-2.496-3.997-2.067" stroke-linecap="round" stroke-linejoin="round"/><path d="M16 18c-4.55 0-6.563 2.667-7 4 0 0 4.245-.727 7-.727S23 22 23 22c-.438-1.333-2.45-4-7-4z" stroke-linejoin="round"/></g></svg>'],Qr="js-feedback";const Zr=class{constructor(t,e,s){this.send=t=>{const e=new Date,s={stepId:this.stepId,option:t,respondedAt:e.toISOString(),debug:this.debug,isPreview:W,isDev:j},i=this.usetifulTags.getUserId();return null!==i&&(s.userId=i),new Promise((t=>{const e="/surveys/{survey_id}/responses/".replace("{survey_id}",this.surveyData.surveyId.toString(10)),i=this.reporterApi.post(e,s);i.onload=()=>{t(i.response)}}))},this.clickButtonHandle=t=>{t.preventDefault();const e=t.target;if(e){const t=e.closest("button"),s=null==t?void 0:t.dataset.value;if(s){const t=Number(s);Number.isNaN(t)||(this.disabledAllButtonElements(),this.send(t).then((()=>{const t=document.querySelector(`.${Qr}`);if(t){t.innerHTML="";const e=this.template.createWrapper("");e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><defs><style>.cls-tick-1{fill:none;stroke:inherit;stroke-linecap:round;stroke-linejoin:round;stroke-width:2px}</style></defs><g id="tick-_tick" data-name="tick"><circle class="cls-tick-1" cx="12" cy="12" r="11"/><path class="cls-tick-1" d="M6 13l3 3 8-8"/></g></svg>';const s=this.template.createWrapper(this.template.themeClasses.feedbackTitle);s.innerHTML=this.surveyData.surveyThankYouMessage,t.appendChild(e),t.appendChild(s)}})))}}},this.init=()=>{const t=document.querySelectorAll(`.${this.template.themeClasses.feedback} button`);t&&t.forEach((t=>{t.addEventListener("click",this.clickButtonHandle)}))},this.disabledAllButtonElements=()=>{const t=document.querySelectorAll(`.${this.template.themeClasses.feedback} button`);t&&t.forEach((t=>{t instanceof HTMLButtonElement&&(t.disabled=!0)}))},this.getContent=()=>"nps"===this.surveyData.surveyType?this.getNpsContent():this.getEmojiesContent(),this.getEmojiesContent=()=>{const t=this.template.createWrapper(this.template.themeClasses.feedback);t.dataset.ufElement="feedback",t.classList.add(Qr);const e=this.template.createWrapper(this.template.themeClasses.feedbackTitle);return e.innerHTML=this.surveyData.surveyQuestion,t.appendChild(e),Yr.forEach(((e,s)=>{const i=document.createElement("button");i.dataset.value=(s+1).toString(10),i.type="button",i.innerHTML=e,t.appendChild(i)})),t},this.getNpsContent=()=>{const t=this.template.createWrapper(this.template.themeClasses.content),e=this.template.createWrapper(this.template.themeClasses.feedback);e.dataset.ufElement="feedback",e.classList.add(Qr),t.appendChild(e);const s=this.template.createWrapper(this.template.themeClasses.feedbackTitle);s.innerHTML=this.surveyData.surveyQuestion,e.appendChild(s);const i=this.template.createWrapper(this.template.themeClasses.buttonGroup);[...Array(11)].forEach(((t,e)=>{const s=e.toString(10),r=document.createElement("button");r.classList.add(this.template.themeClasses.button),r.dataset.value=s,r.type="button",r.innerHTML=s,i.appendChild(r)})),e.appendChild(i);const r=this.template.createWrapper(this.template.themeClasses.npsTitles);if(this.surveyData.surveyMinimalValueLabel){const t=document.createElement("span");t.classList.add(this.template.themeClasses.textLeft),t.innerHTML=this.surveyData.surveyMinimalValueLabel,r.appendChild(t)}if(this.surveyData.surveyMaximalValueLabel){const t=document.createElement("span");t.classList.add(this.template.themeClasses.textRight),t.innerHTML=this.surveyData.surveyMaximalValueLabel,r.appendChild(t)}return e.appendChild(r),t},this.stepId=e,this.surveyData=s,this.template=t,this.debug=O,this.reporterApi=ci(Ks),this.usetifulTags=ci(ti)}},tn="previewTour";const en=class{constructor(t,e,s,i){this.prepareAction=t=>{const e=this.template.createButton(this.actionData.value);switch(this.actionData.type){case ce:e.addEventListener("click",(()=>{Lt({tourId:this.tourId,name:k.goToNextStep})})),e.classList.add(this.template.themeClasses.button);break;case"previous":e.addEventListener("click",(()=>{Lt({tourId:this.tourId,name:k.goToPreviousStep})})),e.classList.add(this.template.themeClasses.button);break;case"goto":e.addEventListener("click",(()=>{this.actionData.url&&(W&&tt("stop preview"),We(this.actionData.url,!0))})),e.classList.add(this.template.themeClasses.button);break;case he:e.addEventListener("click",(()=>{if(!this.actionData.tourId)return void console.warn("TourId in another tour button doesn't exist");const e=parseInt(this.actionData.tourId,10);if(this.isCurrentTour(e)&&Lt({name:k.goToNextStep,details:{display:!1},tourId:this.tourId}),this.actionData.url){!He(window.location.href,this.actionData.url)||Lt({name:k.setTourTriggerToLocalStorage,details:{tourId:e},tourId:this.tourId}),this.isCurrentTour(e)||this.sendCloseTourEvent();const s=Object.assign({},this.actionData);t(s),s.url&&We(s.url,!1)}else if(this.isCurrentTour(e)||(Lt({name:k.setTourTriggerToLocalStorage,details:{tourId:e},tourId:this.tourId}),this.sendCloseTourEvent()),W){const e=Object.assign({},this.actionData);t(e),e.url&&(s=e.url,window.history.replaceState?window.history.replaceState(void 0,"",s):window.location.hash=s,window.location.reload())}else window.USETIFUL.reinitialize();var s})),e.classList.add(this.template.themeClasses.button);break;case"close":e.addEventListener("click",(()=>{Lt({tourId:this.tourId,name:k.closeTour})})),e.classList.add(this.template.themeClasses.button);break;default:e.addEventListener("click",(()=>{Lt({name:k.moveToStep,details:{stepId:this.actionData.to,display:!0},tourId:this.tourId})})),e.classList.add(this.template.themeClasses.button)}return(this.actionData.styleType?this.actionData.styleType===ue:this.actionData.type===ce||this.actionData.type===he)&&e.classList.add(this.template.themeClasses.buttonPrimary),this.template.appendButtonDataAttributes(e),e},this.sendCloseTourEvent=()=>{Lt({name:k.closeTour,details:{reason:ct},tourId:this.tourId})},this.isCurrentTour=t=>t===this.tourId,this.actionData=t,this.template=s,this.tourName=e,this.tourId=i}};class sn{constructor(t,e,s){var i=this;this.doesStepElementExist=t=>null!==Te(`.${this.template.themeClasses.prefix}-${t}`),this.destructStep=t=>{V(`DestructStep: stepName ${this.stepData.name}`),G(this.stepData);const e=null==t?void 0:t.stepData;if(this.stepData){const t=this.stepData.progressOnClick||"",s=this.stepData.element||"",i=new Kr(t,s,this.elementTrigger,this.tourId);switch(this.stepData.type){case ee:this.template.destructElement(this.stepData.name);break;case se:this.template.destructElement(this.stepData.name),i.removeTrigger();break;case te:i.removeTrigger(),this.destroy(),this.template.destructElement(this.stepData.name)}!this.stepData.highlight||!e||e.highlight&&"pointer"===e.type||setTimeout((()=>cr()),10)}},this.placeStepProgressTrigger=()=>{const{stepData:t}=this,e=new Kr((null==t?void 0:t.progressOnClick)||"",t.element||"",this.elementTrigger,this.tourId);t.type===te&&this.isPositionTypeScreen()&&(e.pointerSelector="body"),e.placeTrigger()},this.isAppearsTrigger=()=>{var t,e,s;return(null===(t=this.stepData)||void 0===t?void 0:t.trigger)&&"appears"===(null===(e=this.stepData)||void 0===e?void 0:e.trigger.type)&&""!==(null===(s=this.stepData)||void 0===s?void 0:s.trigger.element)},this.waitForStep=(t,e,s)=>{var i,r;if(V(`WaitForStep called - ${t}`),!t||!(null===(i=this.stepData)||void 0===i?void 0:i.trigger))return;cr();const n=new Re(null===(r=this.stepData)||void 0===r?void 0:r.trigger,this.availableOnPage);n.triggerFunction=e,n.failFunction=s,n.altSolution=()=>{this.showAlternativeSolution(!0)};n.setAppearTrigger()&&(window.usetiful_intervals.push(n.intervalId),n.intervalId&&this.tour.waiters.push(n.intervalId))},this.constructStep=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=rt;if(i.isDevKit=e,V(`constructStep: step index ${i.tour.getCurrentStepIndex()}, display: ${t}`),t&&Lt({name:k.setProgress,details:{status:a},tourId:i.tourId}),i.doesStepElementExist(i.stepData.name)){const t=Te(`.${i.template.themeClasses.prefix}-${i.stepData.name}`);return t&&Ie(t)?void i.showCurrentStep():void 0}switch(W&&!i.isAppearsTrigger()&&Z(),i.stepData.type){case ee:i.isAppearsTrigger()?i.waitForStep(t,(()=>{i.prepareModal(t),W&&Z()})):i.prepareModal(t);break;case se:i.isAppearsTrigger()?i.waitForStep(t,(()=>{i.prepareSlideout(t),W&&Z()})):i.prepareSlideout(t);break;case te:if(!i.isCreatingIntervalRunning&&null==i.prepareStepPointer(t))return;break;case ie:s=nt,i.stepData.tourName&&""!==i.stepData.tourName&&Lt({name:k.setTourTriggerToLocalStorage,details:{tourId:"self"!==i.stepData.tourName?i.stepData.tourId:i.tourId},tourId:i.tourId});if(new Xr(i,i.tour).makeAutoRedirect())return;"self"===i.stepData.tourName?Lt({name:k.goToNextStep,details:{display:!1},tourId:i.tourId}):Lt({name:k.closeTour,tourId:i.tourId}),i.stepData.url&&window.localStorage.setItem(f,i.stepData.url);break;case re:if(i.stepData.delay){s=ot,V(`constructStep: Delay step. Waiting for ${i.stepData.delay}sec.`);const t=1e3*i.stepData.delay;window.usetiful_tourDelayTimeoutVar=setTimeout((()=>{Lt({tourId:i.tourId,name:k.goToNextStep}),window.usetiful_tourDelayTimeoutVar=void 0}),t)}break;case ne:s=at;new Xr(i,i.tour).runTriggerEvent(),Lt({tourId:i.tourId,name:k.goToNextStep});break;case oe:{s=lt,i.tourId&&Lt({tourId:i.tourId,name:k.setTourTriggerToLocalStorage});const t=new Xr(i,i.tour);i.tourTriggers.clearTourTriggerAfterDelay(i.tourId,!0),i.performActionWithPotentialRedirect(i.tour.goToNextStep),t.runPageAction();break}}!t||i.localStorageTourHandler.isTourReopenFromLS(i.tour.name)&&0!==i.tour.getCurrentStepIndex()||window.usetiful_isAboutToRefresh?V("constructStep: reopen action is not send into report"):br(i.tourId,i.tour.getCurrentStepIndex(),s,i.stepData.id,i.isDevKit)},this.showAlternativeSolution=t=>{var e;if(O){Le(`.${this.template.themeClasses.notification}`);const s=t?`Step '${this.stepData.title}' can't be shown because the element <b>'${null===(e=this.stepData.trigger)||void 0===e?void 0:e.element}' didn't appear in given time limit</b> so the trigger timed out. <a href="https://usetiful.freshdesk.com/support/solutions/articles/77000481466-triggering-by-element-appears" target="_blank">Learn more</a>`:`Step '${this.stepData.title}' can't be shown. Pointing element <b>'${this.stepData.element}' doesn't exist on this page or is hidden</b>. <a href="https://usetiful.freshdesk.com/support/solutions/articles/77000488290-why-is-my-pointer-showing-in-right-bottom-corner-" target="_blank">Learn more</a>`;this.template.notifyUser("tour","Alert",s,(()=>{const t=this.template.createWrapper(this.template.themeClasses.actions),e=this.template.createLink("Close tour");e.addEventListener("click",(t=>{Le(`.${this.template.themeClasses.notification}`),this.tour.closeTour(),t.stopImmediatePropagation(),t.preventDefault()}),!1);const s=this.template.createLink("< Previous step");return s.addEventListener("click",(t=>{Le(`.${this.template.themeClasses.notification}`),this.tour.goToPreviousStep(),t.stopImmediatePropagation(),t.preventDefault()}),!1),t.append(s),t.append(e),t}),[r.alert],(()=>{}))}else{V(`constructAborted.Element ${this.stepData.element} doesn't exist`),this.tour.currentStep.destructStep();const t=new sn(this.stepData,this.tour,this.template);t.stepData.type=se,t.stepData.trigger={},t.stepData.actions||(t.stepData.actions=[{type:"previous",value:"<"},{type:"next",value:">"}]);const e=this.tour.getStepIndex(this.id);this.tour.updateCurrentStep(e),t.constructStep(!0)}},this.prepareModal=t=>{const e=this.template.createWrapper(this.template.themeClasses.modal);e.dataset.ufContent="modal",t&&e.classList.add(r.visible),e.classList.add(`${this.template.themeClasses.prefix}-${this.stepData.name}`);const s=this.template.createWrapper(this.template.themeClasses.modalInner),i=document.body.appendChild(e);this.stepData.customStyle&&(de(this.stepData.customStyle,s),pe(this.stepData.customStyle,s));const n=i.appendChild(s);this.appendInnerElement(n),t&&window.scrollTo({top:0}),this.setStepElement(i)},this.prepareSlideout=t=>{const e=this.template.createWrapper(this.template.themeClasses.slideout);e.dataset.ufContent="slideout",e.classList.add(`${this.template.themeClasses.prefix}-${this.stepData.position}`,`${this.template.themeClasses.prefix}-${this.stepData.name}`),t&&e.classList.add(r.visible);const s=this.template.createWrapper(this.template.themeClasses.slideoutInner),i=document.body.appendChild(e),n=i.appendChild(s);this.stepData.customStyle&&(de(this.stepData.customStyle,n),pe(this.stepData.customStyle,n)),this.appendInnerElement(n),this.placeStepProgressTrigger(),this.setStepElement(i)},this.failToDisplayPointer=()=>{cr(),this.stepData.autoskip&&this.tour.autoSkip(this.stepData.autoskip)},this.prepareStepPointer=t=>{if(this.isPositionTypeElement()&&this.stepData.element){const e=Te(this.stepData.element),s=this.isAppearsTrigger();if(!e||Ie(e))return this.stepData.autoskip?(s?(V("prepareStepPointer: Step has trigger elementAppears. Waiting on the step element..."),this.waitForStep(t,(()=>{W&&Z(),this.createPointer(!0)}),this.failToDisplayPointer)):(V(`prepareStepPointer: Step index ${this.tour.getCurrentStepIndex()} will be skipped.`),this.failToDisplayPointer()),null):(s||this.stepData.trigger?(V("prepareStepPointer: Step has trigger elementAppears. Waiting on the step element..."),this.waitForStep(t,(()=>{W&&Z(),this.createPointer(!0)})),this.isCreatingIntervalRunning=!1):(cr(),K(`prepareStepPointer: We couldn't find element of step ${this.stepData.name}. Showing alternative solution...`),this.doubleDelay()),null);this.createPointer()}else this.isPositionTypeScreen()&&this.createPointer();return!0},this.createPointer=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];i.prepareBubble(),i.placeStepProgressTrigger(),t&&br(i.tourId,i.tour.getCurrentStepIndex(),rt,i.stepData.id,i.isDevKit)},this.prepareBubble=()=>{var t,e,s,i;if(this.stepData&&this.stepData.element){const t=Te(this.stepData.element);this.setTargetElement(t)}if(this.isPositionTypeElement()&&!this.getTargetElement())return void V("Element doesn't exist");const r=""!==(null===(t=this.stepData)||void 0===t?void 0:t.title)&&!0===(null===(e=this.stepData)||void 0===e?void 0:e.publicTitle),n=this.template.createTitle(4,this.stepData.title,r);let o=null;this.tour.isProgress()&&(o=this.getProgressBar());const a=this.tour.tourData,{progressType:l}=a,c=this.template.createBubble({ident:this.stepData.name,contentHTML:this.stepData.content?this.stepData.content:"",title:n||null,progressBar:o,alignment:this.stepData.alignment?this.stepData.alignment:"down",actionNumbers:(null===(s=this.stepData.actions)||void 0===s?void 0:s.length)?null===(i=this.stepData.actions)||void 0===i?void 0:i.length:0,progressType:l,closeButton:this.createCloseButton(),appendAdditionalContent:t=>{this.prepareFeedback(t),(!this.stepData.progressOnClick||"button"===this.stepData.progressOnClick)&&this.stepData.actions&&this.stepData.actions.length>0&&t.appendChild(this.prepareActions())},hotspot:!1,customStyle:this.stepData.customStyle?this.stepData.customStyle:null,theme:this.tour.theme});this.positionPointerElement(),window.onresize=()=>{this.onResizeActions(c)},this.setStepElement(c);const h=setInterval((()=>{const t=this.getStepElement();t&&t.offsetHeight>0&&(this.scrollIntoView(),clearInterval(h))}),100)},this.onResizeActions=t=>{this.isPositionTypeElement()&&this.getTargetElement()&&t&&!Ie(this.getTargetElement())&&!Ie(t)&&this.scrollIntoView()},this.scrollIntoView=()=>{var t,e,s;V("scroll bubble into view");try{const i=null===(t=this.getStepElement())||void 0===t?void 0:t.getAttribute("data-floating-placement");if(i&&function(t,e,s){return!(!s||!e)&&(t===ae||t===le?e.offsetHeight+s.offsetHeight>.9*window.innerHeight:e.offsetHeight>.9*window.innerHeight)}(i,this.getTargetElement(),this.getStepElement())){const t=i===ae?"end":"start";null===(e=this.getStepElement())||void 0===e||e.scrollIntoView({behavior:"smooth",block:t})}else{const t=window.innerWidth<=600?"end":"center";null===(s=this.getTargetElement())||void 0===s||s.scrollIntoView({behavior:"smooth",block:t})}}catch(t){}},this.positionPointerElement=()=>{const{stepData:t}=this,e=`.${this.template.themeClasses.prefix}-${t.name}`;return t.type===te&&this.availableOnPage.checkElement(e)?(V(`positionPointerElement: Checking position: ${t.name}`),this.isPositionTypeElement()&&t.element&&this.availableOnPage.checkElement(t.element)&&this.setTargetElement(Te(t.element)),this.setStepElement(Te(e)),this.create()):(V("positionPointerElement: Element disappeared..."),!1)},this.appendInnerElement=t=>{const{title:e,publicTitle:s,content:i,progressOnClick:r,actions:n,alignment:o}=this.stepData,a=""!==e&&!0===s,l=t,c=this.template.createWrapper(this.template.themeClasses.content),h=this.template.createTitle(3,e,a);a||c.classList.add(this.template.themeClasses.contentWithoutTitle),c&&i&&(c.innerHTML=ge(i)),l.appendChild(this.createCloseButton()),h&&l.appendChild(h),this.tour.isProgress()&&l.appendChild(this.getProgressBar()),l.appendChild(c),this.prepareFeedback(l),(!r||"button"===r&&n&&n.length>0)&&l.appendChild(this.prepareActions());const{progressType:u}=this.tour.tourData;l.appendChild(this.template.createSpaceMaker(o,null==n?void 0:n.length,u));ci(ai.watermark)&&l.appendChild(this.template.createWatermarkBadge()),this.template.checkScrollableClass(c)},this.createCloseButton=()=>{const t=this.template.createButton('<svg xmlns="http://www.w3.org/2000/svg"><path stroke="#000" stroke-width="2" d="M1 16L16 1M1 1l15 15"/></svg>',this.template.themeClasses.buttonClose);return t.addEventListener("click",(()=>{this.tour.closeTour()})),t},this.prepareFeedback=t=>{var e;if(null===(e=this.stepData.surveyData)||void 0===e?void 0:e.feedback){const e=new Zr(this.template,this.stepData.id,this.stepData.surveyData);t.appendChild(e.getContent()),e.init()}},this.prepareActions=()=>{if(!this.stepData)return;const t=this.template.createWrapper(this.template.themeClasses.actions);if(this.stepData.alignment&&t.classList.add(this.stepData.alignment),this.stepData.actions)for(const e of this.stepData.actions){const s=new en(e,this.tour.name,this.template,this.tourId).prepareAction(this.modifyURLBeforeRedirect);s&&t.appendChild(s)}return t},this.getProgressBar=()=>{const t=this.tour.getTour(),e=this.localStorageTourHandler.getCurrentStepIndexLS(this.tour.id);return this.template.progressBarController(this.stepData,t,e)},this.modifyURLBeforeRedirect=t=>{let e=t;t||(e=this.stepData),e.url||(e.url=window.location.href);let s=!1;if(!He(window.location.href,e.url)&&e.tourId){const t=this.tour.getNextStep(),i=!t,r=e.tourId.toString()!==this.tour.id.toString();if((r||!i&&!r)&&(e.url+=`${W?`${Me(e.url)?"&":"#"}${tn}-`:`?${h}=`}${e.tourId}`,s=!0,!i&&!r)){const s=this.tour.getStepIndex(t.name);e.url+=W?`-${s}-${"self"===e.tourName?this.tour.name:e.tourName}`:`&${u}=${s}`}}s||"self"===e.tourName||W&&e.tourId&&(e.url+=`${Me(e.url)?"&":"#"}${tn}-${e.tourId}`)},this.elementTrigger=t=>{var e;G(t);const s=[t.target];t.target&&t.target.parentElement&&(s.push(t.target.parentElement),t.target.parentElement.parentElement&&s.push(t.target.parentElement.parentElement));for(let t=0;t<s.length;t+=1){const e=s[t];if(e&&e.classList.contains(this.template.themeClasses.buttonClose))return}V("elementTrigger: trigger called",!0);const i=null===(e=this.tour.getCurrentStep())||void 0===e?void 0:e.stepData;if(!(!!i&&i.runDefaults)&&t&&(K(`elementTrigger: Preventing default ${t.type} action.`),t.preventDefault()),!this.tour)return!1;this.tourTriggers.setTourTriggerToLocalStorage(this.tour.id),this.tourTriggers.clearTourTriggerAfterDelay(this.tour.id,!0),this.performActionWithPotentialRedirect(this.tour.goToNextStep)},this.performActionWithPotentialRedirect=t=>{Lt({tourId:this.tourId,name:k.listenForRedirect}),setTimeout((()=>{t()}),1)},this.isPositionTypeElement=()=>{var t;return!((!this.stepData||this.stepData.positionType)&&"element"!==(null===(t=this.stepData)||void 0===t?void 0:t.positionType))},this.isPositionTypeScreen=()=>{var t;return"screen"===(null===(t=this.stepData)||void 0===t?void 0:t.positionType)},this.id=t.id,this.name=t.name,this.stepData=t,this.stepElement=null,this.targetElement=null,this.tour=e,this.tourId=e.id,this.template=s||new Be,this.tourTriggers=ci(Xs),this.isCreatingIntervalRunning=!1,this.localStorageTourHandler=ci(ni),this.availableOnPage=ci(ii),this.isDevKit=!1}setStepData(t){this.stepData=t}getStepData(){return this.stepData}setStepElement(t){this.stepElement=t}getStepElement(){return this.stepElement}setTargetElement(t){this.targetElement=t}getTargetElement(){return this.targetElement}update(){this.floatingInstance&&this.floatingInstance()}destroy(){var t;window.usetiful_floatUpdateCanceler&&window.usetiful_floatUpdateCanceler(),window.usetiful_floatScrollUpdateCanceler&&window.usetiful_floatScrollUpdateCanceler(),this.floatingInstance=null,null===(t=this.unsubscribeElementRemove)||void 0===t||t.call(this),this.unsubscribeElementRemove=void 0}create(){V("StepControl::create called.");const t=this.isPositionTypeScreen(),e=t?(t=>{var e;if(!t||!t.coordinates)return null;let{top:s,left:i,right:r,bottom:n}=t.coordinates;"number"!=typeof s&&(s=parseInt(s,10)),"number"!=typeof i&&(i=parseInt(i,10)),"number"!=typeof r&&(r=parseInt(r,10)),"number"!=typeof n&&(n=parseInt(n,10));const{width:o,height:a}=(null===(e=document.body)||void 0===e?void 0:e.getBoundingClientRect())||{},l=(t,e,s)=>t||e?t||s-e:s/2,c=l(s,n,a),h=l(i,r,o);return{getBoundingClientRect:()=>{var t,e,s;const i=(null===(t=document.body)||void 0===t?void 0:t.getBoundingClientRect())||{},r=h+(null!==(e=null==i?void 0:i.left)&&void 0!==e?e:0),n=c+(null!==(s=null==i?void 0:i.top)&&void 0!==s?s:0);return{x:h,y:c,width:0,height:0,top:n,right:i.width-r,bottom:i.height-n,left:r}}}})(this.stepData):this.getTargetElement(),s=this.getStepElement();if(!e||!s)return;const i=!t&&Ie(e);if(i)return V("Target element is hidden."),void this.hideCurrentStep();if(!i&&null!==this.getStepElement()&&Ie(this.getStepElement())&&(V("Showing step element."),this.showCurrentStep()),V("Updating current coordinates because target element and step element aren't hidden."),(this.floatingInstance||this.unsubscribeElementRemove)&&(this.destroy(),V("Destroying floatingInstance just before creating new one - may be destroy should be called explicitly before")),V("Start calculation of new coordinates"),this.stepData&&s&&e){const i="absolute",r=vr(this.stepData.position),n=!t&&this.stepData.highlight?gr(i):void 0;this.floatingInstance=()=>Tr({targetElement:e,bubble:s,orientation:r,extraModifier:[mr(n)]}),window.usetiful_floatScrollUpdateCanceler=ar(e,s,this.floatingInstance,{ancestorScroll:!0}),window.usetiful_floatUpdateCanceler=ar(e,s,this.floatingInstance,{animationFrame:!0}),this.unsubscribeElementRemove=((t,e)=>{let s;try{const i=[];let r=t.parentNode;for(;r;)i.push(r),r=r.parentNode;s=new MutationObserver((s=>{s.forEach((s=>{"childList"===s.type&&Array.from(s.removedNodes).find((t=>i.includes(t)))&&e(t)}))}));const n={attributes:!1,childList:!0,subtree:!0};i.length&&s.observe(i[i.length-1],n)}catch(t){}return function(){null==s||s.disconnect()}})(e,(()=>{this.hideCurrentStep(),cr(),this.destroy()}))}}showCurrentStep(){this.stepElement&&dr(this.stepElement)}hideCurrentStep(){this.stepElement&&pr(this.stepElement)}doubleDelay(){window.usetiful_tourPointerWaitingForElement=setTimeout((()=>{const{element:t}=this.stepData;t&&this.availableOnPage.checkElement(t)&&!Ie(Te(t))?this.createPointer(!0):window.usetiful_tourPointerWaitingForElement=setTimeout((()=>{t&&this.availableOnPage.checkElement(t)&&!Ie(Te(t))?this.createPointer(!0):this.showAlternativeSolution(!1)}),1500)}),1500)}}const rn=sn;const nn=class{constructor(t,e){var s=this;this.goToNextStepEvent=t=>{this.goToNextStep(t.detail.props&&void 0!==t.detail.props.display?t.detail.props.display:void 0)},this.goToPreviousStepEvent=()=>{this.goToPreviousStep()},this.closeTourEvent=t=>{this.closeTour(t.detail.props&&t.detail.props.reason?t.detail.props.reason:void 0)},this.setTourTriggerToLocalStorageEvent=t=>{this.tourTriggers.setTourTriggerToLocalStorage(t.detail.props&&t.detail.props.tourId?t.detail.props.tourId:this.id)},this.moveToStepEvent=t=>{if(!t.detail.props)return;let{stepId:e}=t.detail.props;if("string"==typeof t.detail.props.stepId){const s=parseInt(t.detail.props.stepId,10);s&&s.toString()===e&&(e=s)}this.moveToStep({display:t.detail.props.display,stepIdent:e})},this.setProgressEvent=t=>{this.localStorageTourHandler.setProgressToLocalStorage(t,this.getTour(),this.getCurrentStepIndex()),this.state=t},this.eventHandler=t=>{if(t.detail.tourId&&t.detail.tourId===this.id)switch(t.detail.event){case k.goToNextStep:this.goToNextStepEvent(t);break;case k.goToPreviousStep:this.goToPreviousStepEvent();break;case k.closeTour:this.closeTourEvent(t);break;case k.setTourTriggerToLocalStorage:this.setTourTriggerToLocalStorageEvent(t);break;case k.moveToStep:this.moveToStepEvent(t);break;case k.setProgress:t.detail.props&&t.detail.props.status&&this.setProgressEvent(t.detail.props.status);break;case k.placeNextStepAppearTrigger:this.placeNextStepAppearTrigger()}},this.placeTourListeners=()=>{document.addEventListener(k.tourEvents,this.eventHandler)},this.removeTourListeners=()=>{document.removeEventListener(k.tourEvents,this.eventHandler)},this.runTour=t=>{let{display:e=!1,startStep:s,isDevKit:i=!1,runByParent:r}=t;V(`runTour: Starting tour = ${this.tourData.name}, display = ${e}, licence = ${ci(ai.license)}, startStep = ${s}`,!0),this.placeTourListeners();const n=this.localStorageTourHandler.getObjectStatus(this.tourData.id.toString());if(i){if(n===a)return void K("Tour that you want to launch is already running");this.closeTour()}kt(!e);const{id:o,steps:c,theme:h,showEverytime:u}=this.tourData;let{autoplay:d}=this.tourData;Lt({isToursContext:!0,name:k.setCurrentTour,details:{value:this}}),this.loader.loadTheme(h,(()=>this.currentStep.update())),this.template.setTheme(h),this.template.setIsWatermark(ci(ai.watermark));let p=this.localStorageTourHandler.getCurrentStepIndexLS(o);if(s&&s>0)p=s;else{const t=this.localStorageTourHandler.getObjectState(this.tourData.id.toString(),"currentStep");p=t||0}const g=this.currentStep.getStepData();if(g&&g.type===ie&&p>0&&"self"!==g.tourName&&(V("runTour: Current step is redirect. Moving to the previous step."),V(`runTour: ${g.tourName}`),p-=1),!r&&this.isButton()&&Y(this.tourData,this.localStorageTourHandler)&&(ci(ii).checkAvailableOnPage(this.tourData.targets,this.tourData.targetOperator)||W)?this.currentMainButton.placeUsetifulButton(this.tourData):this.currentMainButton.getButtonElement()&&this.currentMainButton.destroy(),e||u||n!==l){if(e)d=e,this.stepTriggersController.placeTourTriggers(c,this.triggerEvent,this.reverseTriggerEvent),this.updateCurrentStep(p),this.currentStep.placeStepProgressTrigger();else if(!d)return console.warn("Shouldn't be displayed and is manual tour"),void Q(this.currentStep.stepData,e);this.currentStep.isAppearsTrigger()?(Q(g),this.currentStep.waitForStep(e,(()=>{Z(),this.moveToStep({stepIndex:p,display:e,isDevKitDirect:!1,isDevKitIndirect:i})}))):this.moveToStep({stepIndex:p,display:d,isDevKitDirect:!1,isDevKitIndirect:i})}else console.warn("Tour has been seen and shouldn't be displayed")},this.destroy=()=>{this.removeTourListeners(),this.clearWaiters()},this.closeTour=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];var i,r,n,o;W&&tt("close tour"),(s.tourTriggers&&!s.tourTriggers.hasTourTrigger(s.id)||0===s.currentStepIndex)&&kt(!0);let c=t;const h=s.getTour();if(!h||s.localStorageTourHandler.getObjectStatus(h.id.toString())!==a)return V("call closeTour but there is no running tour at this moment."),ur(),void s.getCurrentStep().destructStep();V(`closeTour: tour: ${h.name}, with reason: ${t}`,!0),c||(c=ht),br(h.id,s.getCurrentStepIndex(),c,s.currentStep.stepData.id,e),ur(),s.triggers&&s.triggers.triggersClearance(!0),s.clearWaiters(),s.getCurrentStep().destructStep(),(t===ct&&!s.currentStep.stepData.tourName||void 0===t||(null===(r=null===(i=s.getCurrentStepData())||void 0===i?void 0:i.getStepData())||void 0===r?void 0:r.type)===ie&&"self"!==(null===(o=null===(n=s.getCurrentStepData())||void 0===n?void 0:n.getStepData())||void 0===o?void 0:o.tourName))&&(s.tourTriggers.removeTriggerFromLocalStorage(h.name),s.tourTriggers.removeTriggerFromLocalStorage(h.id)),!s.isLastStep()&&h.rememberLastStep||s.resetCurrentStep(),s.setProgressEvent(l),V(`closeTour: ${h.name} has been closed.`,!0),(()=>{const t=new CustomEvent(k.initContentLoader);document.dispatchEvent(t)})(),s.removeTourListeners(),Lt({isToursContext:!0,name:k.placeInitialTriggers}),Lt({isToursContext:!0,name:k.placeAllButton})},this.clearWaiters=()=>{this.waiters&&this.waiters.length>0&&(this.waiters.forEach((t=>{clearInterval(t)})),this.waiters=[])},this.destructStepByName=t=>{const e=this.steps.find((e=>e.stepData.name===t));e&&e.destructStep()},this.triggerEvent=t=>{V(`triggerEvent called with param ${t}`,!0),""!==t&&this.moveToStep({stepIdent:t,display:!0})},this.reverseTriggerEvent=t=>{V(`reverseTriggerEvent called with param ${t}`),this.destructStepByName(t)},this.placeNextStepAppearTrigger=()=>{if(this.hasNextStep()){const t=this.getNextStep(),e=!0;if(t&&t.isAppearsTrigger()){const s=this.getStepIndex(t.stepData.name);s&&t.waitForStep(e,(()=>{this.moveToStep({stepIndex:s,display:e})}),(()=>{t.stepData.autoskip?(this.currentStep.destructStep(t),cr(),this.updateCurrentStep(s),this.autoSkip(t.stepData.autoskip)):t.showAlternativeSolution(!1)}))}}},this.autoSkip=t=>{var e;if(t){V("call autoSkip");const t=null===(e=this.getNextStep(!1))||void 0===e?void 0:e.stepData;t&&(t.type===ee||t.type===se||t.element&&Te(t.element))?t.trigger?"appears"===t.trigger.type&&Te(t.trigger.element)&&this.goToNextStep():this.goToNextStep():t?this.goToNextStep():(K("The last step of your tour has been autoskiped. Closing tour... "),this.closeTour())}},this.goToPreviousStep=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];V("call goToPreviousStep"),s.moveToStep({stepIndex:s.getCurrentStepIndex()-1,display:!0,isDevKitDirect:t})},this.goToNextStep=function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];V("call goToNextStep"),V(`current step index is ${s.getCurrentStepIndex()}`);let i=t;window.usetiful_isAboutToRefresh&&(i=!1),s.moveToStep({stepIndex:s.getCurrentStepIndex()+1,display:i,isDevKitDirect:e})},this.getStepIndex=t=>{let e=-1;const s=this.getStepByIdent(t);return s&&(e=this.steps.indexOf(s)),e},this.getStepByIdent=t=>{let e;return e="string"==typeof t?this.getStepByName(t):this.getStepById(t),e},this.getStepById=t=>{let e;return this.steps&&(e=this.steps.find((e=>e.id===t))),e},this.getStepByName=t=>{let e;return this.steps&&(e=this.steps.find((e=>e.name===t))),e},this.moveToStep=t=>{var e,s;const{stepIdent:i,stepIndex:r,display:n,isDevKitDirect:o,isDevKitIndirect:l}=t;o&&this.checkRunningTour(),window.usetiful_tourDelayTimeoutVar&&(clearTimeout(window.usetiful_tourDelayTimeoutVar),window.usetiful_tourDelayTimeoutVar=void 0),window.usetiful_tourPointerWaitingForElement&&(clearTimeout(window.usetiful_tourPointerWaitingForElement),window.usetiful_tourPointerWaitingForElement=void 0);let c=-1;if(void 0!==i){V(`Move to stepId: ${i}`,!0);const t=this.getStepIndex(i);t>=0&&(c=t)}else void 0!==r&&(V(`Move to stepIndex: ${r}`,!0),c=r);const h=c-this.currentStepIndex<0;let u=i?this.getStepByIdent(i):this.getStepByIndex(c);if(u){let t=u.stepData;if(0===c&&this.stepTriggersController.isAutomatedStep(t)){Q(this.getNextStep(),n)}else Q(t,n);const r=`.${this.template.themeClasses.prefix}-${this.currentStep.stepData.name}`,d=Te(r),p=`.${this.template.themeClasses.prefix}-${t.name}`,g=Te(p);if(this.currentStep.stepData.name!==i&&d&&(V("JumpTo: Previous step is still visible so need to be destructed."),this.currentStep.destructStep(u)),c&&g)return;const m=t&&t.element?Te(t.element):null;if(h&&((!m||Ie(m))&&(null==t?void 0:t.autoskip)||this.stepTriggersController.isAutomatedStep(t))&&(V("Moving to previous step"),c-1>=0)){const s=this.getStepByIndex(c-1);t=null===(e=((t,e)=>{if(e.isTour()){if("string"==typeof t){const s=e.getStepIndex(t);if(s&&s>=0)return e.getStepByIndex(s)}if("number"==typeof t)return e.getStepByIndex(t)}return null})(null==s?void 0:s.stepData.name,this))||void 0===e?void 0:e.stepData,u=s,c-=1}V(`Move to step: ${null==t?void 0:t.name}, display:${n}`),u&&"number"==typeof c&&(n&&!this.localStorageTourHandler.isTourReopenFromLS(this.name)&&(this.getCurrentStepIndex()!==c?this.currentStep.destructStep(u):null===(s=this.getStepByIndex(this.localStorageTourHandler.getCurrentStepIndexLS(this.id)))||void 0===s||s.destructStep(u)),this.updateCurrentStep(c),n?(u.constructStep(n,o||l),this.updateTriggers()):this.setProgressEvent(a))}else{if(o)throw new Error("Step not found");V("JumpTo: Step not found"),this.currentStep.destructStep(),this.resetCurrentStep(),this.getTour()&&this.isButton()&&this.moveToStep({stepIndex:0,display:!1}),this.closeTour()}},this.updateTriggers=()=>{this.stepTriggersController.placeTourTriggers(this.tourData.steps,this.triggerEvent,this.reverseTriggerEvent)},this.tourData=t,this.name=t.name,this.id=t.id,this.steps=[],this.triggers=ci(Ys),this.loader=ci(Qs),this.currentMainButton=ci(si),this.tourTriggers=ci(Xs),this.template=new Be,t.steps.forEach((t=>{this.steps.push(new rn(t,this,this.template))})),this.localStorageTourHandler=ci(ni),this.currentStepIndex=0,this.currentStep=this.steps[0],this.state=l,this.waiters=[],this.stepTriggersController=e}setTour(t){this.tourData=t}getTour(){return this.tourData}isTour(){return null!==this.tourData}isProgress(){var t;return null==(null===(t=this.tourData)||void 0===t?void 0:t.progress)||this.tourData.progress}isButton(){var t;return null==(null===(t=this.tourData)||void 0===t?void 0:t.button)||this.tourData.button}getStepByIndex(t){return this.getStepsLength()>0&&"number"==typeof t&&this.steps[t]||null}getSteps(){var t;return(null===(t=this.tourData)||void 0===t?void 0:t.steps)||[]}getCurrentStep(){return this.currentStep}getCurrentStepData(){return this.getStepByIndex(this.currentStepIndex)}getCurrentStepIndex(){return this.currentStepIndex?this.currentStepIndex:0}setCurrentStepIndex(t){this.currentStepIndex=t}updateCurrentStep(t){this.setCurrentStepIndex(t);const e=this.steps[t];e&&(this.currentStep=e)}resetCurrentStep(){this.currentStepIndex=0}isFirstStep(){return 0===this.currentStepIndex}isLastStep(){return!(!this.tourData||!this.tourData.steps)&&this.currentStepIndex>=this.tourData.steps.length-1}getPreviousStep(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return t&&this.currentStepIndex>0&&(this.currentStepIndex-=1),this.getStepByIndex(t?this.currentStepIndex:this.currentStepIndex-1)}getNextStep(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return t&&(this.currentStepIndex+=1),this.getStepByIndex(t?this.currentStepIndex:this.currentStepIndex+1)}hasPreviousStep(){return null!==this.getPreviousStep()}hasNextStep(){return this.currentStepIndex+1<this.getStepsLength()}getStepsLength(){return this.tourData&&this.tourData.steps?this.tourData.steps.length:0}isSteps(){return!!this.tourData&&(this.tourData.steps&&this.getStepsLength()>0)}checkRunningTour(){if(this.localStorageTourHandler.getObjectStatus(this.id.toString())!==a)throw new Error("You should run a tour first")}};const on=class{constructor(t){this.placeTourTriggers=(t,e,s)=>{V("placeTourTriggers: Placing tour triggers..."),t.forEach(((t,i)=>{let{trigger:r,name:n}=t;if(!r||0===i)return;const o=new Re(r,this.availableOnPage);o.triggerFunction=e,o.stepId=n,o.isInitial=!1,o.reverseTriggerFunction=s,this.CommonTriggersControl.placeTrigger(o)})),V("placeTourTriggers: Placed triggers:"),G(window.usetiful_activeTriggersOnElements)},this.placeInitialTriggers=(t,e)=>{V("placeInitialTriggers");for(const s of t){let t=s.steps[0].stepData.trigger;t=!t&&s.steps[1]&&this.isAutomatedStep(s.steps[0].stepData)?s.steps[1].stepData.trigger:t;const{id:i}=s.tourData;if(t&&i&&Y(s.tourData,this.localStorageHandler)){const r=new Re(t,this.availableOnPage);r.isInitial=!0,r.triggerFunction=t=>{e(t,i)},r.reverseTriggerFunction=s.reverseTriggerEvent,this.CommonTriggersControl.placeTrigger(r)}}},this.isAutomatedStep=t=>!!(t&&t.type&&[re,ie,ne,oe].indexOf(t.type)>-1),this.CommonTriggersControl=ci(Ys),this.localStorageHandler=ci(ni),window.usetiful_activeTriggersOnElements=[],window.usetiful_activeListeners=[],this.availableOnPage=t}};window.USETIFUL||(window.USETIFUL={});window.USETIFUL.reinitialize=()=>{At()};const an=t=>{const e=t.target;if(!e)return;const s=e.closest(".uf-form-question");if(null!==s){const t=s.getAttribute("id");switch(e.tagName.toLowerCase()){case"input":switch(e.getAttribute("type")){case"radio":hn(t,e.value);break;case"checkbox":setTimeout((()=>{hn(t,ln(s))}),100);break;default:cn("focusout",t,e)}break;case"select":cn("change",t,e);break;case"textarea":cn("focusout",t,e)}}},ln=t=>{const e=[],s=t.querySelectorAll("input");return s.length>0&&s.forEach((t=>{t.checked&&e.push(t.value)})),e.toString()},cn=(t,e,s)=>{s.addEventListener(t,(()=>{hn(e,s.value)}),{once:!0})},hn=(t,e)=>{if(!t)return;if(V(`Value of '${t}' is going to be updated to '${e}' `),0===e.length)return void(t=>{const e=localStorage.getItem(mt);if(e){const s=JSON.parse(e);null!==s[t]&&(delete s[t],window.localStorage.setItem(mt,JSON.stringify(s)))}})(t);const s=localStorage.getItem(mt);if(s){const i=JSON.parse(s);null!==i[t]&&e!==i[t]&&(i[t]=e,window.localStorage.setItem(mt,JSON.stringify(i)),me())}else{const s={};s[t]=e,window.localStorage.setItem(mt,JSON.stringify(s)),me()}};class un{constructor(t){var e=this;this.setTours=t=>{for(const e of t)this.tours.push(new nn(e,this.stepTriggersController))},this.placeAllButtonEvent=()=>{this.currentMainButton.placeAllButtons(this.availableTours,Y,this.localStorageTourHandler)},this.placeInitialTriggersEvent=()=>{this.stepTriggersController.placeInitialTriggers(this.availableTours,this.runTourOnClick)},this.setCurrentTour=t=>{t.detail.props.value instanceof nn&&(this.currentTour=t.detail.props.value)},this.beforeUnloadListener=()=>{window.usetiful_isAboutToRefresh=!0,Lt({name:k.stopListeningForRedirect,isToursContext:!0})},this.beforeUnloadEvent=()=>{this.beforeUnload.setAction(pt,this.beforeUnloadListener)},this.stopBeforeUnloadEvent=()=>{this.beforeUnload.removeAction(pt)},this.eventHandler=t=>{if(t.detail.isToursContext)switch(t.detail.event){case k.placeAllButton:this.placeAllButtonEvent();break;case k.placeInitialTriggers:this.placeInitialTriggersEvent();break;case k.setCurrentTour:this.setCurrentTour(t);break;case k.listenForRedirect:this.beforeUnloadEvent();break;case k.stopListeningForRedirect:this.stopBeforeUnloadEvent()}},this.addTourEventsListeners=()=>{document.addEventListener(k.toursEvents,this.eventHandler)},this.removeTourEventsListeners=()=>{document.removeEventListener(k.toursEvents,this.eventHandler)},this.destroy=()=>{V("destroy tours object"),this.tourInitClearExistingTimeouts(),this.checkingTargetsInterval&&window.clearInterval(this.checkingTargetsInterval),this.availableTours=[],this.availableOnPage.refreshURL(),Le("[data-uf-button='button-main']"),this.commonTriggers.triggersClearance(!0);const t=document.querySelectorAll("[data-uf-content]");if(t.length>0&&t.forEach((t=>{ke(t)})),this.removeTourEventsListeners(),this.tours.length>0&&(this.tours.forEach((t=>{t.destroy()})),this.tours=[]),this.currentTour&&this.currentTour.isTour()&&this.currentTour.getCurrentStep()){const t=this.currentTour.currentStep;t.destructStep(),(t&&t.stepData.highlight||!t.stepData.highlight&&document.querySelectorAll(r.overlay).length>0)&&cr()}},this.init=()=>{this.addTourEventsListeners(),V(`toursInit: Customer's license: ${ci(ai.license)}`),this.tourTriggers.checkTourTriggers(),this.checkAvailableTours(),(t=>{const e={start:e=>{const s=t.tours.find((t=>t.id===e));if(!s)throw new Error("Your tour Id is not valid!");s.runTour({display:!0,isDevkit:!0})},nextStep:()=>{var e;null===(e=t.currentTour)||void 0===e||e.goToNextStep(void 0,!0)},preStep:()=>{var e;null===(e=t.currentTour)||void 0===e||e.goToPreviousStep(!0)},close:()=>{var e;null===(e=t.currentTour)||void 0===e||e.closeTour(void 0,!0)},jumpTo:e=>{var s;null===(s=t.currentTour)||void 0===s||s.moveToStep({stepIndex:e-1,display:!0,isDevKitDirect:!0})},getState:()=>{const e=localStorage.getItem(q);let s=[];e&&(s=JSON.parse(e));const i=[];return t.availableTours.forEach((t=>{const e=s.find((e=>e.id===t.id)),r={name:t.name,id:t.id,isAvailable:!0,state:e?e.state:"never run"};e&&"inProgress"===e.state&&(r.currentStep=null==e?void 0:e.currentStep),i.push(r)})),s.forEach((e=>{t.availableTours.find((t=>e.id===t.id))||(e.isAvailable=!1,"inProgress"!==e.state&&delete e.currentStep,i.push(e))})),i}};window.USETIFUL.tour=e})(this),window.addEventListener("click",an),window.addEventListener("focusin",an)},this.checkAvailableTours=()=>{let t=!1;V("checkAvailableTours"),this.checkingTargetsInterval=window.setInterval((()=>{var e;let s=null;if(V("Checking available tours..."),0===this.availableTours.length){for(const e of this.tours){const{id:i,name:r,targets:n,targetOperator:o}=e.tourData;let a=this.tourTriggers.hasTourTrigger(i)||this.tourTriggers.hasTourTrigger(r);const l=W&&M===e.id,c=this.availableOnPage.checkAvailableOnPage(n,o);if(a&&null===s){const t=window.localStorage.getItem(f);(t&&this.availableOnPage.checkURL(t)||!t)&&(s=e),t&&(setTimeout((()=>{window.localStorage.removeItem(f)}),1500),s||(a=!1)),this.tourTriggers.clearTourTriggerAfterDelay(e.id),this.tourTriggers.clearTourTriggerAfterDelay(e.name)}(c||l)&&this.availableTours.push(e),t||W||c||a||this.localStorageTourHandler.closeInProgressTour(e.id,e.name)}t=!0,kt(null===s&&0===this.availableTours.length&&!((null===(e=this.currentTour)||void 0===e?void 0:e.getTour())&&this.localStorageTourHandler.getObjectState(this.currentTour.getTour().id.toString(),"state")===a))}else clearInterval(this.checkingTargetsInterval),this.setAvailableTours();null!==s&&(clearInterval(this.checkingTargetsInterval),s.runTour({display:!0,startStep:this.tourTriggers.stepTriggerFromURL}))}),500),this.checkingTargetsInterval&&-1===window.usetiful_intervals.indexOf(this.checkingTargetsInterval)&&window.usetiful_intervals.push(this.checkingTargetsInterval)},this.setAvailableTours=()=>{V("initAvailableTours: List of available tours for this page:",!0),G(this.availableTours),V("initAvailableTours: List of StepTriggersControl:"),G(this.tourTriggers.getTriggers());let t=null,e=null,s=!1,i=!1;for(const r of this.availableTours){const{name:n,autoplay:o,showEverytime:c}=r.tourData;this.localStorageTourHandler.getObjectStatus(n)===a&&(null==e?(e=r,i=!0):i=!1),o&&(this.localStorageTourHandler.getObjectStatus(n)!==l||c)&&(null==t?(t=r,s=!0):s=!1)}if(i&&e)return V(`initAvailableTours: There is one tour (id: ${e.id}) that has state in progress`),void e.runTour({display:!0});if(s&&t)return V("initAvailableTours: There is only one autoplay ready tour"),void t.runTour({display:!0});if(this.availableTours.length>0)if(this.placeAllButtonEvent(),this.placeInitialTriggersEvent(),1===this.availableTours.length){V("There is only one tour that can be run");const t=this.availableTours[0];if(t.tourData.showEverytime||this.localStorageTourHandler.getObjectStatus(t.name)!==l||t.tourData.button){const e=t.tourData.autoplay&&(this.localStorageTourHandler.getObjectStatus(t.tourData.name)!==l||t.tourData.showEverytime);t.runTour({display:e})}}else{kt(!0);const t=[];this.availableTours.forEach((e=>{e.tourData.autoplay&&t.push(`\n${e.id} - ${e.name}`)})),t.length>=2&&console.warn(`Usetiful: There are ${t.length} autoplayed tours available on this page: ${t.toString()} \n and we can't decide which one to display first.`)}else K("initAvailableTours: No tour available on this page.");kt(!0)},this.tourInitClearExistingTimeouts=()=>{window.usetiful_tourDelayTimeoutVar&&(clearTimeout(window.usetiful_tourDelayTimeoutVar),window.usetiful_tourDelayTimeoutVar=void 0),window.usetiful_tourPointerWaitingForElement&&(clearTimeout(window.usetiful_tourPointerWaitingForElement),window.usetiful_tourPointerWaitingForElement=void 0)},this.runTourOnClick=function(t,s){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:()=>{};const n=e.getTourByID(s);var o;n?(V("runTourOnClick called"),V(n.tourData.name),n.state!==a?("function"==typeof r&&r(),null!==e.localStorageTourHandler.isAnyTourRunning(e.availableTours)&&e.localStorageTourHandler.getObjectStatus(s.toString())!==a?e.template.confirmation("Switch to another tour",`Do you want to switch to the tour '${n.tourData.name}'?`,"Yes","No",(()=>{var t;const s=e.localStorageTourHandler.isAnyTourRunning(e.availableTours);if(s&&(!e.currentTour||e.currentTour&&e.currentTour.id.toString()!==s)){const t=e.getTourByID(parseInt(s,10));t&&(e.currentTour=t)}null===(t=e.currentTour)||void 0===t||t.closeTour(),"function"==typeof r&&r(),n.runTour({display:!0,runByParent:i})}),""):n.runTour({display:!0,runByParent:i}),t&&(t.stopImmediatePropagation(),"wheel"!==(o=t).type&&"scroll"!==o.type&&t.preventDefault())):K("Tour that you want to run is already running.")):K("Tour that you want to run does not exist.")},this.getTourByID=t=>this.tours.find((e=>e.id===t)),this.toursData=t,this.currentTour=null,this.availableTours=[],this.commonTriggers=ci(Ys),this.tourTriggers=ci(Xs),this.localStorageTourHandler=ci(ni),this.currentMainButton=ci(si),this.template=new Be,this.availableOnPage=ci(ii),this.stepTriggersController=new on(this.availableOnPage),this.tours=[],this.setTours(this.toursData),this.beforeUnload=ci(Js)}}(()=>{const{localStorage:t}=window;li.registerConstant(ai.apiToken,$),li.registerConstant(ai.isPluginScript,E),li.registerConstant(ai.reporterBasePath,"reporter/api"),li.registerClass(Vs,Ct,[ai.apiToken]),li.registerClass(Ks,Ct,[ai.apiToken,ai.reporterBasePath]),li.registerConstant(ai.LocalStorage,t),li.registerClass(Js,Nt,[Js]),li.registerClass(Qs,Bt,[Vs,Js]),li.registerClass(ti,Xt,[Vs]),li.registerClass(Gs,yt,[Vs,Ks,ti,Js]),li.registerClass(Xs,Et,[ai.LocalStorage]),li.registerClass(Zs,Ut,[ai.apiToken,ti,Js,Vs]),li.registerConstant(ai.tourType,_s),li.registerConstant(ai.smartTipsType,qs),li.registerConstant(ai.tourStorageKeyName,q),li.registerConstant(ai.smartTipsGroupStorageKeyName,z),li.registerClass(ni,zs,[ai.tourType,ai.tourStorageKeyName,Zs]),li.registerClass(oi,zs,[ai.smartTipsType,ai.smartTipsGroupStorageKeyName,Zs]),li.registerClass(ei,Zt,[ai.isPluginScript,Zs]),li.registerClass(ri,Fs,[ni]),li.registerClass(si,Ne,[Qs]),li.registerClass(ii,Hs,[ni]),li.registerClass(Ys,je,[ii])})();const dn=ci(Qs),pn=ci(ti),gn=ci(Js),mn=ci(Zs),fn=ci(ri),vn=ci(Gs);window.usetiful_intervals=[];let Tn=null,wn=null,bn=null,Sn=null,yn=null;dn.loadCriticalCss(),dn.loadConfig((t=>Cn(t)));const Cn=t=>{let{tours:e=[],smartTipsGroups:s=[],checklists:i=[],assistants:r=[],licence:n,reportPrivacyMode:o,watermark:a}=t;var l;fn.init(e),hi(ai.license,n),hi(ai.watermark,a),kn(),pn.setReportDataPrivacy(parseInt(o,10)),window.usetiful_intervals.length>0&&(l=window.usetiful_intervals,V(`Cleaning ${l.length} intervals...`),l.forEach((t=>{clearInterval(t)})),window.usetiful_intervals=[]),Sn&&(Sn=null),bn&&(bn=null),wn&&(wn.destroy(),wn=null),Tn&&(Tn.destroy(),Tn=null),vn&&vn.destroy(),mn&&mn.destroy(),gn&&gn.destroy(),window.usetifulTags||(window.usetifulTags={}),window.removeEventListener("click",an),window.removeEventListener("focusin",an),(()=>{const t=localStorage.getItem(mt);if(t){const e=JSON.parse(t);Object.assign(window.usetifulTags,e)}})(),yn=new Cr(s),wn=new un(e),Sn=new Jr(r,wn.runTourOnClick),bn=new Ur(i,wn.runTourOnClick),Tn=new Vr(Sn,bn,wn),gn.init(),mn.init(),yn.init(),wn.init(),Tn.init(),vn.init()},kn=()=>{const t=ci(ti).getTag("userId");t&&t===g&&console.error("Invalid UserID provided to Usetiful. Replace sample value with unique identificator for each logged-in user. Read more about how to use userIDs on https://help.usetiful.com/support/solutions/articles/77000514872-user-id-for-cross-device-support")}})();